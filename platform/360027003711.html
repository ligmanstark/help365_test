<!DOCTYPE html>
<html lang="ru">

<head>
    <title>Синтаксис шаблонов</title>
    <meta name="generator" content="Help+Manual" />
    <meta name="keywords" content="" />
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Шаблон документа, загружаемый в ELMA365, может содержать любой текст, переменные, функции, условия и&nbsp;циклы. Добавляя шаблон в&nbsp;бизнес-процесс, вы&nbsp;сможете связать&nbsp;поля из&nbsp;вашего..." />
    <meta name="picture" content="" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="Cправка по Low-code платформе ELMA365" />
    <meta property="og:url" content="https://elma365.com/ru/help" />
    <meta property="og:image" content="" />
    <meta property="og:site_name" content="ELMA365" />                                                              
    <link rel="icon" href="favicon.png" type="image/png" />
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="./jquery-ui.css" />
    <link rel="stylesheet" href="default.css" />
    <link rel="stylesheet" href="./search-yandex.css" />
    <link rel="stylesheet" href="./article.css" />
    <link rel="stylesheet" href="./glossary.css" />
    <link rel="stylesheet" href="./theme.css" />
   <script type="text/javascript" src="jquery.js"></script>
   <script type="text/javascript" src="helpman_settings.js"></script>
   <script type="text/javascript" src="helpman_topicinit.js"></script>

   <script type="text/javascript" src="highlight.js"></script>
   <script type="text/javascript">
     $(document).ready(function(){highlight();});
   </script>
</head>

<body>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-M6ETBEC1R9"></script><script>window.dataLayer=window.dataLayer || []; function gtag(){dataLayer.push(arguments);}gtag('js', new Date()); gtag('config', 'G-M6ETBEC1R9');</script>
    <script>!function(e,t,c,n,r,a,m){e.ym=e.ym||function(){(e.ym.a=e.ym.a||[]).push(arguments)},e.ym.l=1*new Date;for(var s=0;s<document.scripts.length;s++)if(document.scripts[s].src===n)return;a=t.createElement(c),m=t.getElementsByTagName(c)[0],a.async=1,a.src=n,m.parentNode.insertBefore(a,m)}(window,document,"script","https://mc.yandex.ru/metrika/tag.js"),ym(83179930,"init",{clickmap:!0,trackLinks:!0,accurateTrackBounce:!0,webvisor:!0})</script><noscript><div><img alt=""src=https://mc.yandex.ru/watch/83179930 style=position:absolute;left:-9999px></div></noscript> 
    
    ﻿<header class="header elma-365">
  <div class="container">
    <a class="header__logo" href="https://elma365.com/ru/help">
      <img src="./logo.svg">
    </a>
 <!-- <div class="hero__search-form" id="search-panel">
   <form class="search-form" onsubmit="ym(83179930,'reachGoal','poisk')">
     <label class="search-form__label">
       <span id="reset-search" class="search__icon"></span>
       <input class="search-form__input" type="text">
     </label>
     <input class="search-form__submit" type="submit" value="Submit">
   </form>
  </div>       -->
  
     <div class="hero__search-form" id="search-panel"> <form class="search-form"> <label class="search-form__label"> <span id="reset-search" class="search__icon"></span> <input class="search-form__input" type="text"> </label> <input class="search-form__submit" type="submit" value="Submit"> </form> </div> 
  <div class="hero__search">
      <a href="#" id="search-icon" class="hero__search-icon">
        <img src="search-icon-white.svg" alt="search string">
      </a>
      <a href="#" id="side-menu-icon" class="hero__side-icon">
        <img src="side_menu.svg" alt="side menu">
      </a>
    </div>  
  <div class="header__navi">
        
        <ul class="header__list"><li><span class="solution-select"><span class="solution-select__selected"></span><svg width="7" height="4" viewBox="0 0 7 4" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M1 1L3.5 3.5L6 1" stroke="white" stroke-linecap="round" stroke-linejoin="round"/></svg><ul class="solution-select__list"><li><a class="project-link" href="https://elma365.com/ru/help/platform/get-trial.html">Платформа</a></li><li><a class="project-link" href="https://elma365.com/ru/help/ecm/ecm-functions.html">ECM</a></li><li><a class="project-link" href="https://elma365.com/ru/help/crm/crm_overview.html">CRM</a></li><li><a class="project-link" href="https://elma365.com/ru/help/service/service-functions.html">Service</a></li><li><a class="project-link" href="https://elma365.com/ru/help/projects/projects-functions.html">Проекты</a></li><li><a class="project-link" href="https://elma365.com/ru/help/business_solutions/-elma365-store.html">Бизнес-решения</a></li></ul></span></li><li><a href="https://api.elma365.com/ru/"target="_blank">API</a></li><li><a href="https://tssdk.elma365.com/"target="_blank">SDK</a></li><li><a href="https://community.elma365.com/" target="_blank">Community</a></li><li><a href="https://elma-academy.com/ru/" target="_blank">Академия</a></li><li><a href="https://elma365.com/ru/" target="_blank">Сайт ELMA365</a></li></ul> 
        
        
   </div>
  </div>

</header>



    
    <main class="main container">

        <aside class="sidebar" id="sidebar">
        <div class="sidebar__header">
                 <a class="header__logo" href="https://elma365.com/ru/help">
                    <img src="./logo-light.svg">
                 </a>
                    <span class="sidebar__close elma-365-close" id="close"></span>
            </div>
            <div class="sidebar__wrapper" id="side-menu">
                
            </div>
        </aside>

        <article class="article" id="article">
            <div class="article-inner">           
                <div class="content">
                    <header class="article__header">
                        
                            <div class="topic__breadcrumbs">
                                <p>Дизайнер бизнес-процессов &gt; <a href="360026936731.html">Шаблоны документов</a> / Синтаксис шаблонов</p>
                            </div>
                        
                        <div class="topic__title"><h1 class="p_Heading1" style="text-align: center; margin: 19px 0 19px 0;"><span class="f_Heading1" style="font-size: 32px;">Синтаксис шаблонов</span></h1>
</div>
                    
</header>
                    <section class="article__content">
                        <div class="scroll-top-inner">
                            <a href="#h1-article" class="scroll-top"></a>
                        </div>
                        <!-- Placeholder for topic body. -->
                        <p class="p_Normal" style="margin: 14px 0 0 0;"><a href="360026936731.html" class="topiclink">Шаблон документа</a>, загружаемый в ELMA365, может содержать любой текст, переменные, функции, условия и циклы. Добавляя шаблон в бизнес-процесс, вы сможете <a href="360026720792.html#bind_shablon" class="topiclink">связать поля</a> из вашего шаблона с контекстными переменными процесса.</p>
<h2 class="p_Heading2" style="margin: 19px 0 0 0;"><span class="f_Heading2" style="font-size: 24px;">Переменные</span></h2>
<p class="p_Normal" style="margin: 19px 0 0 0;">Все переменные в шаблоне должны иметь следующий формат: <code><b>{$имя_переменной}</b></code>. Имя переменной уникально и пишется латинскими буквами, например, <code><b>{$kontragent}</b></code>. Такая переменная позволит подставить наименование контрагента при создании договора в <a href="360026720792.html" class="topiclink">бизнес‑процессе</a>.</p>
<p style="margin: 19px 0 0 0;">В шаблоне можно использовать атрибуты полей из контекста приложения, т. е. обращаться к вложенным переменным. Доступно для полей типа <a href="360009707032.html#file_type" class="topiclink">Файлы</a>, <a href="360009707032.html#users" class="topiclink">Пользователи</a>, <a href="360009707032.html#app" class="topiclink">Приложение</a>, <a href="360009707032.html#arbitrary-app" class="topiclink">Произвольное приложение</a> и т. д.</p>
<p style="margin: 19px 0 0 0;">Например, в заказе есть поле <span style="font-weight: bold;">Договор</span> (код — <code><b>contract</b></code>), куда загружается файл договора, а также поле <span style="font-weight: bold;">Клиент</span> (код — <code><b>client</b></code>), в которое добавляется элемент приложения <span style="font-weight: bold;">Контакты</span>. В сгенерированном документе можно отобразить название файла или номер телефона клиента. Для этого в синтаксисе шаблона используются код поля из исходного приложения и код вложенной переменной, разделённые точкой: <code><b>{$contract.__name}</b></code> или <code><b>{$client.phone}</b></code>.</p>
<p style="margin: 19px 0 0 0;">При написании функций аргументы и значения переменных заключаются в кавычки. Разрешено использовать следующие виды кавычек: <span style="font-weight: bold;">&quot; &quot;</span>, <span style="font-weight: bold;">« »</span>, <span style="font-weight: bold;">“ “</span>, <span style="font-weight: bold;">” ”</span>, <span style="font-weight: bold;">' '</span>. </p>
<h2 class="p_Heading2" style="margin: 19px 0 0 0;"><span class="f_Heading2" style="font-size: 24px;">Функции</span></h2>
<h3 class="p_Heading3" style="margin: 19px 0 0 0;"><span class="f_Heading3" style="font-size: 19px;">Функции для работы со строчным типом данных</span></h3>
<p class="p_Normal" style="margin: 19px 0 0 0;">Эти функции позволяют выводить текст в разном формате.</p>
<p class="p_Normal" style="margin: 14px 0 0 0;">Для примера в переменной <code><b>$stroka1</b></code> задано значение <span style="font-weight: bold;">Иван Крапивин</span>:</p>
<ol style="list-style-type:upper-roman">
<li value="1" class="p_Normal" style="margin-top: 14px; margin-right: 0; margin-bottom: 0;"><code><b>UpperCase(&lt;param1: строка&gt;)</b></code> — переводит текст в верхний регистр.</li></ol>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">начало&nbsp;примера</span></p>
<p style="margin: 14px 0 0 0;">Пример: </p>
<p style="margin: 14px 0 0 0;"><code><b>{UpperCase({$stroka1})}</b></code> —&gt; ИВАН КРАПИВИН.</p>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">конец&nbsp;примера</span></p>
<ol style="list-style-type:upper-roman" start="2">
<li value="2" class="p_Normal" style="margin-top: 14px; margin-right: 0; margin-bottom: 0;"><code><b>LowerCase(&lt;param1: строка&gt;)</b></code> — переводит текст в нижний регистр.</li></ol>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">начало&nbsp;примера</span></p>
<p style="margin: 14px 0 0 0;">Пример: </p>
<p style="margin: 14px 0 0 0;"><code><b>{LowerCase({$stroka1})}</b></code> —&gt; иван крапивин.</p>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">конец&nbsp;примера</span></p>
<ol style="list-style-type:upper-roman" start="3">
<li value="3" class="p_Normal" style="margin-top: 14px; margin-right: 0; margin-bottom: 0;"><code><b>Capitalize(&lt;param1: строка&gt;)</b></code> — переводит первую букву первого слова в заглавную.</li></ol>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">начало&nbsp;примера</span></p>
<p style="margin: 14px 0 0 0;">Пример: </p>
<p style="margin: 14px 0 0 0;"><code><b>{Capitalize({$stroka1})}</b></code> —&gt; Иван крапивин.</p>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">конец&nbsp;примера</span></p>
<ol style="list-style-type:upper-roman" start="4">
<li value="4" class="p_Normal"><code><b>Substr(&lt;param1: строка&gt;, &lt;from: число&gt;, &lt;length: число&gt;)</b></code> — извлекает часть текста, начиная с указанного символа <code><b>&lt;from&gt;</b></code>, длиной в заданное количество символов <code><b>&lt;length&gt;</b></code>. </li></ol>
<p class="p_Normal">Вы можете заполнить только <code><b>&lt;from&gt;</b></code>, чтобы сохранить весь текст после указанного символа.</p>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">начало&nbsp;примера</span></p>
<p class="p_Normal" style="margin: 14px 0 0 0;">Примеры:</p>
<ul style="list-style-type:disc">
<li style="margin-top: 14px; margin-right: 0; margin-bottom: 0;"><code><b>{Substr({$stroka1}, 0, 3)}</b></code> —&gt; Ива;</li><li><code><b>{Substr({$stroka1}, 3)}</b></code> —&gt; н Крапивин.</li></ul>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">конец&nbsp;примера</span></p>
<h3 class="p_Heading3"><span class="f_Heading3">Функция ToString()</span></h3>
<p class="p_Normal" style="margin: 14px 0 0 0;">Функция <code><b>ToString</b></code> универсальна и позволяет выводить в документе следующие типы данных:</p>
<ul style="list-style-type:disc">
<li><a href="360027003711.html#number" class="topiclink">Число</a>;</li><li><a href="360027003711.html#string" class="topiclink">Строка</a>;</li><li><a href="360027003711.html#string" class="topiclink">Категория</a>;</li><li><a href="360027003711.html#yes_no" class="topiclink">Выбор «да/нет»</a>;</li><li><a href="360027003711.html#money" class="topiclink">Деньги</a>;</li><li><a href="360027003711.html#name" class="topiclink">ФИО</a>;</li><li><a href="360027003711.html#phone" class="topiclink">Телефон</a>;</li><li><a href="360027003711.html#date_time" class="topiclink">Дата/Время</a><span style="background-color: #ffffff;">.</span></li></ul>
<p class="p_Normal" style="margin: 14px 0 0 0;">Подробнее про типы данных в ELMA365 читайте в статье <span style="background-color: #ffffff;"><a href="360009707032.html" class="topiclink">«Типы данных в системе»</a>.</span></p>
<h4 class="p_Heading4"><a id="number" class="hmanchor"></a><span class="f_Heading4">Число</span></h4>
<p class="p_Normal" style="margin: 14px 0 0 0;">Для этого типа данных используется следующий синтаксис: <code><b>ToString(param1: число, &lt;format: строка&gt;, &lt;locale: строка&gt;)</b></code>.</p>
<p class="p_Normal" style="margin: 14px 0 0 0;">Для примера в качестве <code><b>$int1</b></code><span style="font-style: italic;"> </span>будем использовать целое число 546.</p>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">начало&nbsp;примера</span></p>
<p style="margin: 14px 0 0 0;">Пример: </p>
<p style="margin: 14px 0 0 0;"><code><b>{ToString({$int1})}</b></code> —&gt; 546.</p>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">конец&nbsp;примера</span></p>
<p class="p_Normal" style="margin: 14px 0 0 0;">По умолчанию число выводится цифрами. Чтобы вывести число прописью, используйте формат <code><b>astext</b></code>.</p>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">начало&nbsp;внимание</span></p>
<p class="p_Normal">Обратите внимание, дробные числа вывести прописью нельзя.</p>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">конец&nbsp;внимание&nbsp;</span></p>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">начало&nbsp;примера</span></p>
<p style="margin: 14px 0 0 0;">Пример: </p>
<p style="margin: 14px 0 0 0;"><code><b>{ToString({$int1}, astext)}</b></code> —&gt; пятьсот сорок шесть.</p>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">конец&nbsp;примера</span></p>
<p class="p_Normal" style="margin: 14px 0 0 0;">Можно указать локаль, чтобы вывести число прописью на другом языке. Доступные локали:</p>
<ul style="list-style-type:disc">
<li class="p_Normal" style="margin-top: 14px; margin-right: 0; margin-bottom: 0;">русский язык — <code><b>ru–RU</b></code> или <code><b>ru</b></code>;</li><li class="p_Normal" style="margin-top: 14px; margin-right: 0; margin-bottom: 0;">английский язык — <code><b>en–US</b></code> или <code><b>en</b></code>. </li></ul>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">начало&nbsp;примера</span></p>
<p style="margin: 14px 0 0 0;">Пример: </p>
<p style="margin: 14px 0 0 0;"><code><b>{ToString({$int1}, astext, en–US)}</b></code> —&gt; five hundred forty six.</p>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">конец&nbsp;примера</span></p>
<h4 class="p_Heading4"><a id="string" class="hmanchor"></a><span class="f_Heading4">Строка</span></h4>
<p class="p_Normal" style="margin: 14px 0 0 0;">Строка позволяет отобразить в документе текстовую информацию.</p>
<p class="p_Normal" style="margin: 14px 0 0 0;">Для этого типа данных используется следующий синтаксис: <code><b>ToString(param1: строка)</b></code>.</p>
<p class="p_Normal" style="margin: 14px 0 0 0;">Для примера используем переменную <code><b>$str1</b></code> с значением <span style="font-weight: bold;">Отправлено на согласование</span>.</p>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">начало&nbsp;примера</span></p>
<p style="margin: 14px 0 0 0;"><a id="category" class="hmanchor"></a>Пример: </p>
<p style="margin: 14px 0 0 0;"><code><b>{ToString({$str1})}</b></code> —&gt; отправлено на согласование.</p>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">конец&nbsp;примера</span></p>
<h4 class="p_Heading4"><span class="f_Heading4">Категория </span></h4>
<p class="p_Normal" style="margin: 14px 0 0 0;">Тип данных <span style="font-weight: bold;">Категория</span> используется для того, чтобы выбирать определённое значение из списка. Например, при выборе способа оплаты можно указать, производится оплата картой или наличными.</p>
<p class="p_Normal" style="margin: 14px 0 0 0;">Для этого типа данных используется следующий синтаксис: <code><b>ToString(param1: категория)</b></code>.</p>
<p class="p_Normal" style="margin: 14px 0 0 0;">При создании контекстной переменной этого типа в процессе указывается её название и код. Укажите соответствующий код в функции <code><b>ToString</b></code>, чтобы в документе, формируемом по шаблону, отобразилось название переменной.</p>
<p class="p_Normal" style="margin: 14px 0 0 0;">Для примера в качестве переменной <code><b>$enum1</b></code> возьмём оплату картой: <code><b>{ &laquo;code&raquo;: &laquo;karta&raquo;, &laquo;name&raquo;: &laquo;картой&raquo; }</b></code>.</p>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">начало&nbsp;примера</span></p>
<p style="margin: 14px 0 0 0;">Пример: </p>
<p class="p_Normal">Оплата производится <code><b>{ToString({$enum1})}</b></code> —&gt; Оплата производится картой.</p>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">конец&nbsp;примера</span></p>
<p class="p_Normal">Также для типа данных <span style="font-weight: bold;">Категория</span> в шаблон можно вывести название и код категории без использования функции <code><b>ToString</b></code>.</p>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">Начало&nbsp;примера&nbsp;</span></p>
<p class="p_Normal">Примеры: </p>
<ul style="list-style-type:disc">
<li class="p_Normal">Оплата производится <code><b>{$enum1.name}</b></code> —&gt; Оплата производится картой;</li><li class="p_Normal">Оплата производится <code><b>{$enum1}</b></code> —&gt; Оплата производится картой;</li><li class="p_Normal">Код используемой категории: <code><b>{$enum1.code}</b></code> —&gt; Код используемой категории: karta.</li></ul>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">Конец&nbsp;примера</span></p>
<h4 class="p_Heading4"><a id="yes_no" class="hmanchor"></a><span class="f_Heading4">Выбор «да/нет»</span></h4>
<p class="p_Normal" style="margin: 14px 0 0 0;">У этого типа данных два варианта: <span style="font-weight: bold;">Да</span> и <span style="font-weight: bold;">Нет</span>. Вы можете их переименовать, например, <span style="font-weight: bold;">Согласовано</span> и <span style="font-weight: bold;">Не согласовано</span>.</p>
<p class="p_Normal" style="margin: 14px 0 0 0;">Для примера возьмём <code><b>$bool1 = true</b></code>. Вариант <span style="font-weight: bold;">Да</span> (<code><b>yesValue</b></code>) определён как <span style="font-weight: bold;">Согласовано</span>.</p>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">начало&nbsp;примера</span></p>
<p style="margin: 14px 0 0 0;">Пример: </p>
<p style="margin: 14px 0 0 0;"><code><b>{ToString({$bool1})}</b></code> —&gt; Согласовано.</p>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">конец&nbsp;примера</span></p>
<h4 class="p_Heading4"><a id="money" class="hmanchor"></a><span class="f_Heading4">Деньги</span></h4>
<p class="p_Normal" style="margin: 14px 0 0 0;">Вы можете вывести в документе денежную сумму в различном формате.</p>
<p class="p_Normal" style="margin: 14px 0 0 0;">Для этого типа данных используется следующий синтаксис: <code><b>ToString(param1: деньги, &lt;format: string&gt;, &lt;locale: string&gt;)</b></code>.</p>
<p class="p_Normal" style="margin: 14px 0 0 0;"><a class="dropdown-toggle" style="font-style: normal; font-weight: normal; color: #000000; background-color: transparent; text-decoration: none;" href="javascript:HMToggle('toggle','TOGGLE0186A1')">Доступные значения format:</a></p>
<div id="TOGGLE0186A1" class="dropdown-toggle-body" style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 14px 0 0 0;"><table style="border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:0; border:none"><ul style="list-style-type:disc">
<li style="margin-top: 14px; margin-right: 0; margin-bottom: 0;"><code><b>short</b></code> —&gt; 1005, 56 (разделитель тысячных и целой/дробной части соответствует локали);</li><li><code><b>sign</b></code><span style="font-weight: bold;"> </span>—&gt; 1005, 56 RUB;</li><li><code><b>full</b></code><span style="font-weight: bold;"> </span>—&gt; 1005 рублей 56 копеек;</li><li><code><b>astext</b></code><span style="font-weight: bold;"> </span>—&gt; Одна тысяча пять рублей 56 копеек;</li><li><code><b>wildcard</b></code><span style="font-weight: bold;"> </span>—&gt; вы можете задать свой формат, например, <code><b>{ToString({$money1}, &laquo;%i руб. %f коп.&raquo;)}</b></code>. В этом случае сумма отобразится следующим образом: 1005 руб. 56 коп.(<code><b>%i</b></code> — целая часть, <code><b>%f</b></code> — дробная часть).</li></ul>
</td>
</tr>
</table>
</div>
<p class="p_Normal" style="margin: 14px 0 0 0;">В функции можно указать локаль. Доступные локали:</p>
<ul style="list-style-type:disc">
<li class="p_Normal" style="margin-top: 14px; margin-right: 0; margin-bottom: 0;">русский язык — <code><b>ru–RU</b></code> или <code><b>ru</b></code>;</li><li class="p_Normal" style="margin-top: 14px; margin-right: 0; margin-bottom: 0;">английский язык — <code><b>en–US</b></code> или <code><b>en</b></code>.</li></ul>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">начало&nbsp;примера</span></p>
<p style="margin: 14px 0 0 0;">Пример: </p>
<p style="margin: 14px 0 0 0;"><code><b>{ToString({$money1}, full, en)}</b></code> —&gt; 1 005 rubles 56 kopecks.</p>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">конец&nbsp;примера</span></p>
<h4 class="p_Heading4"><a id="name" class="hmanchor"></a><span class="f_Heading4">ФИО</span></h4>
<p class="p_Normal" style="margin: 14px 0 0 0;">Вы можете указать в документе фамилию, имя и отчество в нужном формате и падеже.</p>
<p class="p_Normal" style="margin: 14px 0 0 0;">Для этого типа данных используется следующий синтаксис: <code><b>ToString(param1: ФИО, &lt;format: строка&gt;, &lt;case: строка&gt;)</b></code>.</p>
<p class="p_Normal" style="margin: 14px 0 0 0;"><a class="dropdown-toggle" style="font-style: normal; font-weight: normal; color: #000000; background-color: transparent; text-decoration: none;" href="javascript:HMToggle('toggle','TOGGLE0186A2')">Доступные значения format:</a></p>
<div id="TOGGLE0186A2" class="dropdown-toggle-body" style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 14px 0 0 0;"><table style="border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:0; border:none"><p class="p_Normal" style="margin: 14px 0 0 0;"><code><b>long</b></code> — фамилия, имя и отчество указываются полностью (Сергеев Сергей Николаевич);</p>
<p class="p_Normal" style="margin: 14px 0 0 0;"><code><b>short</b></code> — указываются фамилия и инициалы (Сергеев С. Н.).</p>
</td>
</tr>
</table>
</div>
<p class="p_Normal" style="margin: 14px 0 0 0;"><a class="dropdown-toggle" style="font-style: normal; font-weight: normal; color: #000000; background-color: transparent; text-decoration: none;" href="javascript:HMToggle('toggle','TOGGLE0186A3')">Доступные значения case:</a></p>
<div id="TOGGLE0186A3" class="dropdown-toggle-body" style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 14px 0 0 0;"><table style="border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:0; border:none"><p class="p_Normal"><code><b>nominative</b></code> | именительный | И — именительный;</p>
<p class="p_Normal" style="margin: 14px 0 0 0;"><code><b>genitive</b></code> | родительный | Р — родительный;</p>
<p class="p_Normal" style="margin: 14px 0 0 0;"><code><b>dative</b></code> | дательный | Д — дательный;</p>
<p class="p_Normal" style="margin: 14px 0 0 0;"><code><b>accusative</b></code> | винительный | В — винительный;</p>
<p class="p_Normal" style="margin: 14px 0 0 0;"><code><b>instrumental</b></code> | творительный | Т — творительный;</p>
<p class="p_Normal" style="margin: 14px 0 0 0;"><code><b>prepositional</b></code> | предложный | П — предложный.</p>
</td>
</tr>
</table>
</div>
<p class="p_Normal" style="margin: 14px 0 0 0;">Обратите внимание, функция максимально правильно склоняет имя в том случае, если указано отчество.</p>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">начало&nbsp;примера</span></p>
<p class="p_Normal" style="margin: 14px 0 0 0;">Примеры:</p>
<ul style="list-style-type:disc">
<li style="margin-top: 14px; margin-right: 0; margin-bottom: 0;"><code><b>{ToString({$fio1})}</b></code> —&gt; Сергеев Сергей Николаевич;</li><li><code><b>{ToString({$fio1}, short)}</b></code> —&gt; Сергеев С.Н.;</li><li><code><b>{ToString({$fio1}, short, Р)}</b></code> —&gt; Сергеева С.Н.</li></ul>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">конец&nbsp;примера</span></p>
<p class="p_Normal">Если вы хотите отдельно указать имя, фамилию или отчество, используйте значения, записанные в переменной типа <span style="font-weight: bold;">Ф.И.О.</span>: <code><b>{$executor.fullname.firstname}</b></code>, <code><b>{$executor.fullname.lastname}</b></code>, <code><b>{$executor.fullname.middlename}</b></code>.</p>
<h4 class="p_Heading4"><a id="phone" class="hmanchor"></a><span class="f_Heading4">Телефон</span></h4>
<p class="p_Normal">Вы можете создать маску для ввода телефонного номера. Для этого используется следующий синтаксис: <code><b>ToString({$phone1}, &laquo;+7–XXX–XXX–XX–XX EEE&raquo;)</b></code>.</p>
<p class="p_Normal">Латинские буквы в синтаксисе обозначают:</p>
<ul style="list-style-type:disc">
<li class="p_Normal"><span style="font-weight: bold;">X</span> — основной номер;</li><li class="p_Normal"><span style="font-weight: bold;">E</span> — добавочный номер. </li></ul>
<p class="p_Normal">Если пользователи запишут номер телефона из меньшего количества цифр, чем обозначено в маске для ввода, в готовом документе лишние буквы <span style="font-weight: bold;">Х</span> и <span style="font-weight: bold;">Е</span> не отобразятся. </p>
<p class="p_Normal" style="margin: 14px 0 0 0;">Телефонный номер заполняется цифрами слева направо.</p>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">начало&nbsp;примера</span></p>
<p class="p_Normal" style="margin: 14px 0 0 0;">Примеры:</p>
<ul style="list-style-type:disc">
<li style="margin-top: 14px; margin-right: 0; margin-bottom: 0;"><code><b>{ToString({$phone1}, &laquo;+7—XXX—XXX—XX—XX&raquo;)}</b></code> —&gt; +7–912–345–67–89;</li><li><code><b>{ToString({$phone1}, &laquo;X—XXX—XXX—XX—XX EEE&raquo;)}</b></code> —&gt; 8–912–345–67–89 159;</li><li><code><b>{ToString({$phone1}, &laquo;XX—XX—XX E&raquo;)}</b></code> —&gt; 45–67–89 3.</li></ul>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">конец&nbsp;примера</span></p>
<h4 class="p_Heading4"><a id="date_time" class="hmanchor"></a><span class="f_Heading4">Дата/Время</span></h4>
<p class="p_Normal" style="margin: 14px 0 0 0;">Вы можете указать в шаблоне дату и время, например, дату поставки оборудования по договору. Для этого используется следующий синтаксис: <code><b>ToString(param1: дата/время, &lt;format: строка&gt;, &lt;locale: строка&gt;)</b></code>.</p>
<p class="p_Normal" style="margin: 14px 0 0 0;">У типа данных <span style="font-weight: bold;">Дата/Время</span> есть разные подтипы: <span style="font-weight: bold;">Дата/Время</span>, <span style="font-weight: bold;">Дата</span>, <span style="font-weight: bold;">Время</span>.</p>
<p class="p_Normal">Без указания дополнительных аргументов в документе отображается текущая дата и время.</p>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">начало&nbsp;примера</span></p>
<p class="p_Normal" style="margin: 14px 0 0 0;">Пример:</p>
<p class="p_Normal"><code><b>{ToString({$date1})}</b></code> —&gt; <span style="font-weight: bold;">Дата/время</span> — 09.04.2019 15:18:43; <span style="font-weight: bold;">Дата</span> — 09.04.2019; <span style="font-weight: bold;">Время</span> — 15:18:43.</p>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">конец&nbsp;примера</span></p>
<p class="p_Normal">При использовании в функции формата <code><b>short</b></code> время указывается без уточнения секунд. </p>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">начало&nbsp;примера</span></p>
<p class="p_Normal" style="margin: 14px 0 0 0;">Пример:</p>
<p class="p_Normal"><code><b>{ToString({$date1}, short)}</b></code> —&gt; <span style="font-weight: bold;">Дата/время</span> — 09.04.2019 15:18; <span style="font-weight: bold;">Дата</span> — 09.04.2019; <span style="font-weight: bold;">Время</span> — 15:18.</p>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">конец&nbsp;примера</span></p>
<p class="p_Normal">Если в функции задан формат <code><b>long</b></code>, время будет отображаться с секундами, а дата — с полным названием месяца: </p>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">начало&nbsp;примера</span></p>
<p class="p_Normal" style="margin: 14px 0 0 0;">Пример:</p>
<p class="p_Normal" style="margin: 14px 0 0 0;"><a id="lc1" class="hmanchor"></a><code><b>{ToString({$date1}, long)}</b></code> —&gt; <span style="font-weight: bold;">Дата/время</span> — 09.04.2019 19:18:43; <span style="font-weight: bold;">Дата</span> — 9 апреля 2019 г.; <span style="font-weight: bold;">Время</span> — 19:18:43.</p>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">конец&nbsp;примера</span></p>
<p class="p_Normal" style="margin: 14px 0 0 0;">Вы также можете указать локаль:</p>
<ul style="list-style-type:disc">
<li class="p_Normal" style="margin-top: 14px; margin-right: 0; margin-bottom: 0;">русский язык — <code><b>ru–RU</b></code> или <code><b>ru</b></code>;</li><li class="p_Normal" style="margin-top: 14px; margin-right: 0; margin-bottom: 0;">английский язык — <code><b>en–US</b></code> или <code><b>en</b></code>.</li></ul>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">начало&nbsp;примера</span></p>
<p style="margin: 14px 0 0 0;">Пример:</p>
<p style="margin: 14px 0 0 0;"><code><b>{ToString({$date1}, short, en–US)}</b></code> —&gt; 4/11/19 7:15 am.</p>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">конец&nbsp;примера</span></p>
<p class="p_Normal" style="margin: 14px 0 0 0;">Обратите внимание, подтип <span style="font-weight: bold;">Дата/Время</span> учитывает временную зону компании и выводит дату с учётом этой зоны. Подтипы <span style="font-weight: bold;">Дата</span> и <span style="font-weight: bold;">Время</span> выводят абсолютные значения.</p>
<p class="p_Normal" style="margin: 14px 0 0 0;"><a class="dropdown-toggle" style="font-style: normal; font-weight: normal; color: #000000; background-color: transparent; text-decoration: none;" href="javascript:HMToggle('toggle','TOGGLE0186A4')">Пример:</a></p>
<div id="TOGGLE0186A4" class="dropdown-toggle-body" style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 0;"><table style="border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:0; border:none"><p class="p_Normal" style="margin: 14px 0 0 0;">Для примера мы составили шаблон договора поставки и использовали в нём различные функции и переменные.</p>
<p class="p_Normal" style="margin: 14px 0 0 0;">Затем мы <a href="360026720792.html" class="topiclink">добавили</a> его в бизнес-процесс и связали переменные из шаблона с переменными процесса.</p>
<p class="p_Normal" style="margin: 14px 0 0 0;"><img alt="синт шабл 2" width="972" height="634" style="margin:0;width:972px;height:634px;border:none" src="hmfile_hash_71617b2d.png"/></p>
<p class="p_Normal" style="margin: 14px 0 0 0;">После того как пользователи заполняют эти переменные, а процесс доходит до шага <a href="360026720792.html" class="topiclink">Генерация по шаблону</a>, в системе автоматически создаётся готовый договор.</p>
<p class="p_Normal" style="margin: 14px 0 0 0;"><img alt="20.PNG" title="20.PNG" width="743" height="867" style="margin:0;width:743px;height:867px;border:none" src="360027862732-20.png"/></p>
<p class="p_Normal" style="margin: 14px 0 0 0;">Файл с шаблоном, который использован в этом примере, вы можете <a href="./doc_template.docx" class="filelink">скачать</a> на свой компьютер.</p>
</td>
</tr>
</table>
</div>
<h3 class="p_Heading3"><a id="datetime-function" class="hmanchor"></a><span class="f_Heading3">Функция DateTime()</span></h3>
<p class="p_Normal">Функция <code><b>DateTime()</b></code> позволяет вывести в шаблоне дату и время с указанием формата даты и локали. </p>
<p class="p_Normal">Синтаксис функции: <code><b>DateTime(&lt;формат:строка&gt;,&lt;переменная:дата\время&gt;,&lt;локаль&gt;)</b></code>.</p>
<p class="p_Normal" style="margin: 14px 0 0 0;">Например, вы можете указать дату и время создания элемента.</p>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">Начало&nbsp;примера</span></p>
<p class="p_Normal" style="margin: 14px 0 0 0;">Пример:</p>
<p class="p_Normal" style="margin: 14px 0 0 0;"><code><b>{DateTime(&laquo;YYYY–MM–DD hh:mm:ss&raquo;,{$__createdAt},"ru_RU")}</b></code> —&gt; 2021<span style="font-size: 15px; color: #4d5156; background-color: #ffffff;">–</span>01<span style="font-size: 15px; color: #4d5156; background-color: #ffffff;">–</span>21 08:30:56.</p>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">Конец&nbsp;примера</span></p>
<p class="p_Normal">В шаблоне поддерживаются <span style="font-size: 15px; font-family: Inter;">следующие </span>виды<span style="font-size: 15px; font-family: Inter;"> кавычек: </span><span style="font-size: 15px; font-family: Inter; font-weight: bold;">&quot; &quot;</span><span style="font-size: 15px; font-family: Inter;">, </span><span style="font-size: 15px; font-family: Inter; font-weight: bold;">« »</span><span style="font-size: 15px; font-family: Inter;">, </span><span style="font-size: 15px; font-family: Inter; font-weight: bold;">“ “</span><span style="font-size: 15px; font-family: Inter;">, </span><span style="font-size: 15px; font-family: Inter; font-weight: bold;">” ”</span><span style="font-size: 15px; font-family: Inter;">, </span><span style="font-size: 15px; font-family: Inter; font-weight: bold;">' '</span><span style="font-size: 15px; font-family: Inter;">.</span></p>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">начало&nbsp;примера</span></p>
<p class="p_Normal">Примеры: </p>
<ul style="list-style-type:disc">
<li class="p_Normal"><code><b>{DateTime('"DD" MMMM YYYY',{$__createdAt},"ru_RU")}</b></code> —&gt; &quot;31&quot; августа 2023;</li><li class="p_Normal"><code><b>{DateTime("&laquo;DD&raquo; MMMM YYYY",{$__createdAt},"ru_RU")}</b></code> —&gt; «31» августа 2023;</li><li class="p_Normal"><code><b>{DateTime(&laquo;'DD' MMMM YYYY&raquo;,{$__createdAt},"ru_RU")}</b></code> —&gt; '31' августа 2023.</li></ul>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">конец&nbsp;примера</span></p>
<p class="p_Normal"><span style="font-weight: bold;"><a class="dropdown-toggle" style="font-style: normal; font-weight: bold; color: #000000; background-color: transparent; text-decoration: none;" href="javascript:HMToggle('toggle','TOGGLE0186A5')">Форматы данных:</a></span></p>
<div id="TOGGLE0186A5" class="dropdown-toggle-body" style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 0;"><table style="border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:0; border:none"><p class="p_Normal">&nbsp;<br />
<span style="font-weight: bold;">Вывод данных: </span></p>
<p class="p_Normal"><code><b>M</b></code> — месяц (1) </p>
<p class="p_Normal"><code><b>MM</b></code> — месяц (01) </p>
<p class="p_Normal"><code><b>MMM</b></code> — месяц (Янв) </p>
<p class="p_Normal"><code><b>MMMM</b></code> — месяц (Январь) </p>
<p class="p_Normal"><code><b>D</b></code> — день (2) </p>
<p class="p_Normal"><code><b>DD</b></code> — день (02) </p>
<p class="p_Normal"><code><b>DDD</b></code> — день (ПН) &nbsp;</p>
<p class="p_Normal"><code><b>DDDD</b></code> — день (Понедельник) </p>
<p class="p_Normal"><code><b>YY</b></code> — год (06) </p>
<p class="p_Normal"><code><b>YYYY</b></code> — год (2006) </p>
<p class="p_Normal"><code><b>hh</b></code> — часы (15) </p>
<p class="p_Normal"><code><b>mm</b></code> — минуты (04) </p>
<p class="p_Normal"><code><b>ss</b></code> — секунды (05)</p>
<p class="p_Normal">&nbsp;<br />
<span style="font-weight: bold;">Локаль: &nbsp; </span></p>
<p class="p_Normal"><code><b>en_US</b></code> — английский (США); </p>
<p class="p_Normal"><code><b>en_GB</b></code> — английский (Великобритания); </p>
<p class="p_Normal"><code><b>de_DE</b></code> — немецкий; </p>
<p class="p_Normal"><code><b>fr_FR</b></code> — французский; </p>
<p class="p_Normal"><code><b>ru_RU</b></code> — русский; </p>
<p class="p_Normal"><code><b>es_ES</b></code> — испанский. &nbsp;</p>
</td>
</tr>
</table>
</div>
<h3 class="p_Heading3" style="margin: 19px 0 0 0;"><span class="f_Heading3" style="font-size: 19px;">Функция Now</span></h3>
<p class="p_Normal" style="margin: 19px 0 0 0;">Чтобы подставить в шаблон текущую дату и время с учётом временной зоны, используйте функцию <code><b>Now</b></code>.</p>
<p class="p_Normal" style="margin: 14px 0 0 0;">Синтаксис функции: <code><b>Now(&lt;format: строка&gt;, &lt;locale: строка&gt;, &lt;timezone: строка&gt;)</b></code>:</p>
<ul style="list-style-type:disc">
<li class="p_Normal" style="margin-top: 14px; margin-right: 0; margin-bottom: 0;">с различными значениями <code><b>format</b></code> дата будет выводиться по‑разному;</li></ul>
<p class="p_Normal" style="margin: 14px 0 0 0;"><a class="dropdown-toggle" style="font-style: normal; font-weight: normal; color: #000000; background-color: transparent; text-decoration: none;" href="javascript:HMToggle('toggle','TOGGLE0186A6')">Доступные значения format:</a></p>
<div id="TOGGLE0186A6" class="dropdown-toggle-body" style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 14px 0 0 0;"><table style="border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:0; border:none"><ul style="list-style-type:disc">
<li style="margin-top: 14px; margin-right: 0; margin-bottom: 0;"><code><b>date</b></code> —&gt; дата (13.04.2019);</li><li><code><b>time</b></code><span style="font-weight: bold;"> </span>—&gt; 15:34;</li><li><code><b>timelong</b></code><span style="font-weight: bold;"> </span>—&gt; 15:34:22;</li><li><code><b>datelong</b></code><span style="font-weight: bold;"> </span>—&gt; 13 апреля 2019 г.;</li><li><code><b>short</b></code> (по умолчанию) —&gt; 13.04.2019 15:34.</li></ul>
</td>
</tr>
</table>
</div>
<ul style="list-style-type:disc">
<li class="p_Normal" style="margin-top: 14px; margin-right: 0; margin-bottom: 0;">для <code><b>locale</b></code> доступен русский язык — <code><b>ru–RU</b></code> и английский язык — <code><b>en–US</b></code>;</li></ul>
<ul style="list-style-type:disc">
<li class="p_Normal" style="margin-top: 14px; margin-right: 0; margin-bottom: 0;"><code><b>timezone</b></code> задаётся в формате Europe/Samara, America/Toronto.</li></ul>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">начало&nbsp;примера</span></p>
<p class="p_Normal">Примеры синтаксиса функции:</p>
<ul style="list-style-type:disc">
<li class="p_Normal"><code><b>{Now(datelong, en-US)}</b></code> — длинная дата, en-US;</li><li class="p_Normal"><code><b>{Now(datelong, en)}</b></code> — длинная дата en;</li><li class="p_Normal"><code><b>{Now(date, en)}</b></code> — только дата en;</li><li class="p_Normal"><code><b>{Now(datelong, ru-RU)}</b></code> — длинная дата ru-RU;</li><li class="p_Normal"><code><b>{Now(datelong, ru)}</b></code> — длинная дата ru;</li><li class="p_Normal"><code><b>{Now(date, ru)}</b></code> — только дата ru;</li><li class="p_Normal"><code><b>{Now(time, ru)}</b></code> — только время ru;</li><li class="p_Normal"><code><b>{Now(timelong, ru)}</b></code> — время с секундами ru;</li><li class="p_Normal"><code><b>{Now(short, ru)}</b></code> — дата и время без секунд ru.</li></ul>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">конец&nbsp;примера</span></p>
<h3 class="p_Heading3"><span class="f_Heading3">Функция Count()</span></h3>
<p class="p_Normal">Позволяет получить число элементов, переданных в переменной типа <a href="360009707032.html#table" class="topiclink">Таблица</a> или <a href="360009707032.html#app" class="topiclink">Приложение</a>. Это может быть количество строк в таблице или записей в связанном приложении. </p>
<p class="p_Normal">С помощью функции можно:</p>
<ul style="list-style-type:disc">
<li class="p_Normal">отображать общее число элементов, чтобы оценить объём данных;</li><li class="p_Normal">проверять наличие данных в переменной;</li><li class="p_Normal">выводить только количество записей вместо таблицы;</li><li class="p_Normal">указывать число записей перед таблицей или списком данных и т. д. </li></ul>
<p class="p_Normal">Синтаксис функции: <code><b>{Count({$переменная})}</b></code>. </p>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">Начало&nbsp;примера</span></p>
<p class="p_Normal"><span style="font-weight: bold;">Пример</span></p>
<p class="p_Normal"><code><b>{Count({$report_table})}</b></code> — число строк в таблице отчёта.</p>
<p class="p_Normal"><code><b>{Count({$app})}</b></code> — число элементов в связанном приложении. </p>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">Конец&nbsp;примера</span></p>
<p class="p_Normal">Вы также можете применять функцию с <a href="360027003711.html#cycle" class="topiclink">циклом for</a>.</p>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">Начало&nbsp;примера</span></p>
<p class="p_Normal"><span style="font-weight: bold;">Пример</span></p>
<ol style="list-style-type:decimal">
<li value="1" class="p_Normal">Вывести количество строк таблицы, которая вложена в основную таблицу отчёта:</li></ol>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">{for&nbsp;row&nbsp;in&nbsp;{$report_table}}</span><br />
<span class="f_CodeExample">Subrow&nbsp;count:&nbsp;{Count({$row.execution})}</span><br />
<span class="f_CodeExample">{end}</span></p>
<ol style="list-style-type:decimal">
<li value="2" class="p_Normal">Показать число строк в таблице, которая является свойством связанного приложения:</li></ol>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">{for&nbsp;row&nbsp;in&nbsp;{$app}}</span><br />
<span class="f_CodeExample">Subrow&nbsp;count:&nbsp;{Count({$row.multi})}</span><br />
<span class="f_CodeExample">{end}</span></p>
<p class="p_Normal">где:</p>
<ul style="list-style-type:disc">
<li class="p_Normal"><code><b>app</b></code> — поле, которое ссылается на связанное приложение;</li><li class="p_Normal"><code><b>row.multi</b></code> — поле типа <span style="font-weight: bold;">Таблица</span> в этом приложении.</li></ul>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">Конец&nbsp;примера</span></p>
<h3 class="p_Heading3"><span class="f_Heading3">Функции для склонения по падежам</span></h3>
<p class="p_Normal" style="margin: 14px 0 0 0;">В системе доступны функции для склонения слов и словосочетаний.</p>
<h4 class="p_Heading4"><span class="f_Heading4">FormatFio (ФорматФио)</span></h4>
<p class="p_Normal" style="margin: 14px 0 0 0;">Склоняет ФИО в нужном падеже и выводит в нужном формате, например, только имя и отчество.</p>
<p class="p_Normal" style="margin: 14px 0 0 0;">Синтаксис функции: <code><b>{FormatFio (&lt;ФИО: строка&gt;, &lt;падеж: 1&gt;, &lt;фамилия: 2&gt;)}</b></code>:</p>
<ul style="list-style-type:disc">
<li class="p_Normal" style="margin-top: 14px; margin-right: 0; margin-bottom: 0;"><span style="font-weight: bold;">[1]</span> — падеж обозначается первой буквой или полным названием («и» или «именительный», «р» или «родительный» и т. д.);</li><li class="p_Normal" style="margin-top: 14px; margin-right: 0; margin-bottom: 0;"><span style="font-weight: bold;">[2]</span> — формат отображения ФИО. Допустимые форматы указываются в кавычках, чередуются через пробел, в полной или сокращённой форме: </li></ul>
<ul style="list-style-type:disc"><ul style="list-style-type:circle">
<li class="p_Normal" style="margin-top: 14px; margin-right: 0; margin-bottom: 0;">«фамилия» или «ф.»;</li><li class="p_Normal" style="margin-top: 14px; margin-right: 0; margin-bottom: 0;">«имя» или «и.»;</li><li class="p_Normal" style="margin-top: 14px; margin-right: 0; margin-bottom: 0;">«отчество» или «о.».</li></ul></li></ul>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">начало&nbsp;примера</span></p>
<p class="p_Normal">Пример:</p>
<p class="p_Normal">Данные <code><b>{FormatFio(&laquo;Иванов Иван Иванович&raquo;,р,&laquo;фамилия и. о.&raquo;)}</b></code><span style="font-family: 'Courier New',Courier,monospace;"> </span>—&gt; Данные Иванова И.И.</p>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">конец&nbsp;примера</span></p>
<p class="p_Normal"><span style="font-weight: bold;">Incline (Просклонять)</span></p>
<p class="p_Normal">Данная функция возвращает заданную строку в указанном падеже.</p>
<p class="p_Normal">Синтаксис функции:<span style="font-weight: bold;"> </span><code><b>{Incline(Просклонять) (&lt;Выражение: строка&gt;,&lt;падеж: 1&gt;,&lt;признаки: 2&gt;)}</b></code>:</p>
<ul style="list-style-type:disc">
<li class="p_Normal"><span style="font-weight: bold;">[1]</span> — падеж обозначается первой буквой или полным названием («и» или «именительный», «р» или «родительный» и т. д.). По умолчанию будет использоваться именительный;</li><li class="p_Normal"><span style="font-weight: bold;">[2]</span> — дополнительные признаки комбинируются через пробел:<ul style="list-style-type:circle">
<li class="p_Normal">фио (ф);</li><li class="p_Normal">мужской род (м);</li><li class="p_Normal">женский род (ж);</li><li class="p_Normal">нарицательное (н);</li><li class="p_Normal">одушевлённое (о);</li><li class="p_Normal">неодушевлённое (но)</li></ul></li></ul>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">начало&nbsp;примера</span></p>
<p class="p_Normal">Пример:</p>
<p class="p_Normal"><code><b>{Просклонять('договор подряда',П,м но)}</b></code><span style="font-family: 'Courier New',Courier,monospace;"> </span>—&gt; о договоре подряда.</p>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">конец&nbsp;примера</span></p>
<h4 class="p_Heading4"><span class="f_Heading4">InclineMany (ПросклонятьМнож)</span></h4>
<p class="p_Normal" style="margin: 14px 0 0 0;">Эта функция возвращает заданную строку в указанном падеже и во множественном числе. Параметры такие же, как у функции <span style="font-weight: bold;">Incline</span>.</p>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">начало&nbsp;примера</span></p>
<p class="p_Normal" style="margin: 14px 0 0 0;">Пример:</p>
<p class="p_Normal" style="margin: 14px 0 0 0;"><code><b>{ПросклонятьМнож('договор подряда',П)}</b></code> —&gt; о договорах подряда.</p>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">конец&nbsp;примера</span></p>
<p class="p_Normal"><span style="font-weight: bold;">NumberToString (ЧислоВСтроку)</span></p>
<p class="p_Normal" style="background: #ffffff;"><span style="font-size: 15px; font-family: 'SF Pro Display'; color: #212529;">Данная функция возвращает указанное число в текстовом формате и в заданном падеже.</span></p>
<p class="p_Normal">Правила написание функции:</p>
<ul style="list-style-type:disc">
<li class="p_Normal">параметры <span style="font-weight: bold;">Падеж</span>, <span style="font-weight: bold;">Единица измерения</span> и <span style="font-weight: bold;">Формат отображения числа</span> прописываются в кавычках — <span style="font-weight: bold;">«»</span>;</li><li class="p_Normal">параметры отделяются друг от друга запятой; </li><li class="p_Normal">единица измерения дробной части указывается с помощью вертикальной черты — <span style="font-weight: bold;">|</span>.</li></ul>
<p class="p_Normal" style="background: #ffffff;"><span style="font-size: 15px; font-family: 'SF Pro Display'; color: #212529;">Синтаксис функции:</span><span style="font-size: 15px; font-family: 'SF Pro Display'; color: #212529;"> </span><code><b>{NumberToString(&lt;Число&gt;,&lt;падеж: 1&gt;,&lt;единица измерения: 2&gt;,&lt;объем единицы измерения: 3&gt;,&lt;формат: 4&gt;)}</b></code>:</p>
<ul style="list-style-type:disc">
<li class="p_Normal"><span style="font-weight: bold;">&lt;Число&gt;</span> — число для преобразования в строку;</li></ul>
<ul style="list-style-type:disc">
<li class="p_Normal"><span style="font-weight: bold;">[1]</span> — падеж прописывается с использованием кавычек, например, «И» или «Именительный», «Р» или «Родительный» и т. д. По умолчанию употребляется именительный падеж;</li></ul>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">начало&nbsp;примера</span></p>
<p class="p_Normal">Примеры:</p>
<ul style="list-style-type:disc">
<li class="p_Normal"><code><b>{NumberToString(5634,&laquo;П&raquo;)}</b></code> —&gt; пяти тысячах шестистах тридцати четырех;</li><li class="p_Normal"><code><b>{NumberToString(5634.37,&laquo;Р&raquo;)}</b></code> —&gt; &nbsp;пяти тысяч шестисот тридцати четырех целых тридцати семи сотых.</li></ul>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">конец&nbsp;примера</span></p>
<ul style="list-style-type:disc">
<li class="p_Normal"><span style="font-weight: bold;">[2]</span> — единицы измерения прописывается с использованием кавычек. </li></ul>
<p class="p_Normal" style="margin: 0 0 0 36px;"><span style="font-weight: bold;"><a class="dropdown-toggle" style="font-style: normal; font-weight: bold; color: #000000; background-color: transparent; text-decoration: none;" href="javascript:HMToggle('toggle','TOGGLE0186A7')">Допустимые форматы:</a></span></p>
<div id="TOGGLE0186A7" class="dropdown-toggle-body" style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 36px;"><table style="border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:0; border:none"><ul style="list-style-type:disc"><ul style="list-style-type:circle">
<li class="p_Normal">Название целой части|Название дробной части — «рубль|копейка»;</li><li class="p_Normal">Только целая часть — «рубль».</li></ul></li></ul>
</td>
</tr>
</table>
</div>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">начало&nbsp;примера</span></p>
<p class="p_Normal">Примеры:</p>
<ul style="list-style-type:disc">
<li class="p_Normal"><code><b>{NumberToString(5850,&laquo;П&raquo;,&laquo;рубль&raquo;)}</b></code> —&gt; пяти тысячах восьмистах пятидесяти рублях;</li><li class="p_Normal"><code><b>{NumberToString(5830.35,&laquo;Т&raquo;,&laquo;евро|евроцент&raquo;)}</b></code> —&gt; пятью тысячами восемьюстами тридцатью евро тридцатью пятью евроцентами.</li></ul>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">конец&nbsp;примера</span></p>
<ul style="list-style-type:disc">
<li class="p_Normal"><span style="font-weight: bold;">[3]</span> — объём единиц измерения. Прописывается как число, по умолчанию используется 100;</li></ul>
<ul style="list-style-type:disc">
<li class="p_Normal"><span style="font-weight: bold;">[4]</span> — формат отображения числа. Прописывается с использованием кавычек. Может быть использован без указания параметра <span style="font-weight: bold;">[3]</span>. </li></ul>
<p class="p_Normal" style="margin: 0 0 0 36px;"><span style="font-weight: bold;"><a class="dropdown-toggle" style="font-style: normal; font-weight: bold; color: #000000; background-color: transparent; text-decoration: none;" href="javascript:HMToggle('toggle','TOGGLE0186A8')">Допустимые значения:</a></span></p>
<div id="TOGGLE0186A8" class="dropdown-toggle-body" style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 36px;"><table style="border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:0; border:none"><ul style="list-style-type:disc">
<li class="p_Normal">0 — отображает только дробную часть числа.</li><li class="p_Normal">A или B (латиница) — идентификатор системного формата:<ul style="list-style-type:circle">
<li class="p_Normal">A — {ПЦЧ} {НЦЧ} {ПДЧ} {НДЧ};</li><li class="p_Normal">B — {ПЦЧ} {НЦЧ} {ДЧ} {НДЧ}.</li></ul>
<li class="p_Normal">Пользовательский шаблон отображения целой и дробной частей. Расшифровка значений:<ul style="list-style-type:circle">
<li class="p_Normal">{ЦЧ} или {ЦелаяЧасть} — шаблон для отображения целой части числа;</li><li class="p_Normal">{ДЧ} или {ДробнаяЧасть} — шаблон для отображения дробной части числа;</li><li class="p_Normal">{ЦЧ:Ф} или {ЦелаяЧасть:Ф} — шаблон для отображения целой части числа с использованием формата отображения;</li><li class="p_Normal">{ДЧ:Ф} или {ДробнаяЧасть:Ф} — шаблон для отображения дробной части числа с использованием формата отображения;</li><li class="p_Normal">{ПЦЧ} или {ПрописьЦелойЧасти} — шаблон для отображения целой части числа прописью;</li><li class="p_Normal">{ПДЧ} или {ПрописьДробнойЧасти} — шаблон для отображения дробной части числа прописью;</li><li class="p_Normal">{НЦЧ} или {НаименованиеЦелойЧасти} — шаблон для отображения единиц измерения целой части числа;</li><li class="p_Normal">{НДЧ} или {НаименованиеДробнойЧасти} — шаблон для отображения единиц измерения дробной части числа<span style="font-size: 15px; font-family: 'SF Pro Display'; color: #212529;">.</span></li></ul></li></ul>
<p class="p_Normal">Символ <span style="font-weight: bold;">Ф</span> заменяется на обозначение формата. Доступные форматы можно посмотреть в <a href="https://msdn.microsoft.com/ru-ru/library/fzeeb5cd(v=vs.110).aspx" target="_blank" class="weblink">документации</a>:</p>
</td>
</tr>
</table>
</div>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">начало&nbsp;примера</span></p>
<p class="p_Normal">Примеры:</p>
<ul style="list-style-type:disc">
<li class="p_Normal"><code><b>{NumberToString(46.25,&laquo;И&raquo;,&laquo;ящик|мешок&raquo;,38,&laquo;{ЦЧ}({ПЦЧ}{НЦЧ}) примерно {ДЧ}({ПДЧ}{НДЧ}) и один контейнер&raquo;)}</b></code><span style="font-size: 15px; font-family: 'SF Pro Display'; color: #212529;"> </span>—&gt; 46 (сорок шесть ящиков) примерно 10 (десять мешков) и один контейнер.</li></ul>
<p class="p_Normal" style="margin: 0 0 0 36px;"><span style="font-style: italic;">Примечание: .25 — это четверть. Мы указали, что в целом </span>— <span style="font-style: italic;">38 частей. 38\4 = 9.5 (округляется до 10);</span></p>
<ul style="list-style-type:disc">
<li class="p_Normal"><code><b>{NumberToString(12345.5,&laquo;Д&raquo;,&laquo;бочка|литр&raquo;,60,&laquo;{ЦЧ:N} ({ПЦЧ} {НЦЧ}) и {ДЧ} ({ПДЧ} {НДЧ})&raquo;)}</b></code> —&gt; 12,345.000 (двенадцати тысячам трёмстам сорока пяти бочкам) и 30 (тридцати литрам).</li></ul>
<p class="p_Normal" style="margin: 0 0 0 36px;"><span style="font-style: italic;">Примечание: В значении {ЦЧ:N} </span><span style="font-style: italic; font-weight: bold;">:N</span><span style="font-style: italic;"> — это формат отображения. Данный формат обозначает, что всегда необходимо показывать дробную часть в числе, но, так как в функции дробная часть отделяется, после запятой будут идти нули.</span></p>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">конец&nbsp;примера</span></p>
<h4 class="p_Heading4"><span class="f_Heading4">ChangeKind (ИзменитьРод)</span></h4>
<p class="p_Normal" style="background: #ffffff;"><span style="font-size: 15px; font-family: 'SF Pro Display'; color: #212529;">Данная функция позволяет изменить род прилагательного.</span></p>
<p class="p_Normal" style="background: #ffffff;"><span style="font-size: 15px; font-family: 'SF Pro Display'; color: #212529;">Синтаксис функции: </span><code><b>{ChangeKind(&lt;прилагательное в именительном падеже мужского рода: строка&gt;,&lt;род: 1&gt;)}</b></code><span style="font-size: 15px; font-family: 'SF Pro Display'; color: #212529;">.</span></p>
<p class="p_Normal"><span style="font-weight: bold;">[1]</span> — род и число, в которые нужно преобразовать.</p>
<p class="p_Normal"><span style="font-weight: bold;"><a class="dropdown-toggle" style="font-style: normal; font-weight: bold; color: #000000; background-color: transparent; text-decoration: none;" href="javascript:HMToggle('toggle','TOGGLE0186A9')">Допустимые значения:</a></span></p>
<div id="TOGGLE0186A9" class="dropdown-toggle-body" style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 0;"><table style="border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:0; border:none"><ul style="list-style-type:disc">
<li class="p_Normal">мужской род (м, муж);</li><li class="p_Normal">женский род (ж, жен);</li><li class="p_Normal">средний род (с, ср);</li><li class="p_Normal">множественное число (мн, множ).</li></ul>
<p class="p_Normal">В скобках даны сокращённые варианты.</p>
</td>
</tr>
</table>
</div>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">начало&nbsp;примера</span></p>
<p class="p_Normal">Примеры:</p>
<ul style="list-style-type:disc">
<li class="p_Normal"><code><b>{ChangeKind(спокойный,жен)}</b></code> —&gt; спокойная;</li><li class="p_Normal"><code><b>{ChangeKind(спокойный,мн)}</b></code> —&gt; спокойные.</li></ul>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">конец&nbsp;примера</span></p>
<h4 class="p_Heading4"><span class="f_Heading4">GetPartOfFullName (Фио)</span></h4>
<p class="p_Normal">Функция позволяет получить полное имя или его часть. Синтаксис функции: <code><b>{Фио(&lt;ФИО:строка&gt;,&lt;часть ФИО:1&gt;)}</b></code>. </p>
<p class="p_Normal"><span style="font-weight: bold;">[1]</span> — часть ФИО. </p>
<p class="p_Normal"><span style="font-weight: bold;"><a class="dropdown-toggle" style="font-style: normal; font-weight: bold; color: #000000; background-color: transparent; text-decoration: none;" href="javascript:HMToggle('toggle','TOGGLE0186AA')">Допустимые значения:</a></span></p>
<div id="TOGGLE0186AA" class="dropdown-toggle-body" style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 0;"><table style="border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:0; border:none"><ul style="list-style-type:disc">
<li class="p_Normal">фамилия (ф);</li><li class="p_Normal">имя (и);</li><li class="p_Normal">отчество (о);</li><li class="p_Normal">полноеимя (полн).</li></ul>
<p class="p_Normal">В скобках даны сокращённые варианты.</p>
</td>
</tr>
</table>
</div>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">начало&nbsp;примера</span></p>
<p class="p_Normal">Пример:</p>
<p class="p_Normal"><code><b>{Фио('Пушкин Александр Сергеевич',о)}</b></code> —&gt; Сергеевич.</p>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">конец&nbsp;примера</span></p>
<h4 class="p_Heading4"><span class="f_Heading4">AnotherGenderSecondName (ФамилияПротивоположногоПола)</span></h4>
<p><span style="font-size: 13px;">Функция позволяет получить фамилию противоположного пола.</span></p>
<p><span style="font-size: 13px;">Синтаксис функции: </span><code><b>{ФамилияПротивоположногоПола(&lt;фамилия:строка&gt;)}</b></code><span style="font-size: 13px;">.</span></p>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">начало&nbsp;примера</span></p>
<p class="p_Normal">Пример:</p>
<p class="p_Normal"><code><b>{ФамилияПротивоположногоПола(Петров)}</b></code> —&gt; Петрова.</p>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">конец&nbsp;примера</span></p>
<h3 class="p_Heading3"><span class="f_Heading3">Функция Barcode</span></h3>
<p class="p_Normal" style="margin: 14px 0 0 0;">Функция <code><b>Barcode</b></code> используется для кодирования строки приложения и добавления её в документ в виде штрихкода. Например, таким образом можно сгенерировать штрихкод для регистрационного номера договора или другого уникального номера документа. В дальнейшем с помощью штрихкода можно будет сопоставить документ на бумажном носителе и электронную копию.</p>
<p class="p_Normal" style="margin: 14px 0 0 0;">Взаимодействие ELMA365 с ПО для считывания штрихкодов осуществляется через модули интеграции. Подробнее о них можно прочитать в статьях <a href="360024498352.html" class="topiclink">«Готовые модули»</a> и в <a href="https://api.elma365.com/ru/public-api/guides/IntroWebAPI/" target="_blank" class="weblink">справке по публичному API ELMA365</a>.</p>
<p class="p_Normal" style="margin: 14px 0 0 0;">Генерация штрихкода доступна для форматов Word и Excel.</p>
<p class="p_Normal" style="margin: 14px 0 0 0;">Синтаксис функции: <code><b>GenerateBarcode(&lt;text: строка:1&gt;, &lt;format: формат кода:2&gt;, &lt;высота сгенерированного штрихкода в пикселях&gt;)</b></code>.</p>
<ul style="list-style-type:disc">
<li class="p_Normal"><span style="font-weight: bold;">[1]</span> — строка зависит от формата, указываемого во втором параметре;</li><li class="p_Normal"><span style="font-weight: bold;">[2]</span> — возможные форматы штрихкодов и требования к строке:</li></ul>
<ul style="list-style-type:disc"><ul style="list-style-type:circle">
<li class="p_Normal"><span style="font-weight: bold;">QR Code</span> — любая строка. Поддерживается разрешение до 300 DPI; </li><li class="p_Normal"><span style="font-weight: bold;">EAN-8</span> — строка до восьми цифр, где последняя используется как контрольная;</li><li class="p_Normal"><span style="font-weight: bold;">EAN-13</span> — строка из 12 цифр или 13 цифр, где последняя — контрольная. </li></ul></li></ul>
<ul style="list-style-type:disc">
<li class="p_Normal">высота штрихкода в пикселях — необязательный параметр. Для корректного распознавания высота указывается в зависимости от количества используемых символов.</li></ul>
<p class="p_Normal">С версии системы 2023.11 вы можете указать формат <span style="font-weight: bold;">EAN</span> без уточнения типа. В таком случае штрихкод будет сгенерирован, а его тип будет зависеть от количества цифр в передаваемой строке.</p>
<p class="p_Normal">Если в шаблоне одна и та же строка используется для генерации QR-кода два раза, но при этом указывается разный размер, то в обоих случаях сгенерируется QR-код одинакового размера.</p>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">начало&nbsp;внимание</span></p>
<p style="line-height: 1.28; margin: 0 0 11px 0;">Если при использовании форматов <span style="font-weight: bold;">EAN</span> контрольная сумма не была указана, она добавится автоматически. Для корректной работы сканер штрихкодов следует настроить на работу с данными форматами.</p>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">конец&nbsp;внимание</span></p>
<p class="p_Normal">Мы рекомендуем использовать формат <span style="font-weight: bold;">QR Code</span>, так как он не имеет таких строгих ограничений, как форматы <span style="font-weight: bold;">EAN</span>.</p>
<p class="p_Normal">Для примера возьмём строку <code><b>$numberstring = «5901234123457»</b></code>. Она подойдёт для формата <span style="font-weight: bold;">QR Code</span> и <span style="font-weight: bold;">EAN-13</span>. </p>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">начало&nbsp;примера</span></p>
<p style="margin: 14px 0 0 0;">Примеры:</p>
<ul style="list-style-type:disc">
<li class="p_Normal"><code><b>{GenerateBarcode({$numberstring}, "QR Code", "125" )}</b></code>;</li><li class="p_Normal"><code><b>{GenerateBarcode({$numberstring}, "EAN-13", "125" )}</b></code>.</li></ul>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">конец&nbsp;примера</span></p>
<p class="p_Normal">Для формата <span style="font-weight: bold;">EAN-8</span> в строке должно быть не больше восьми цифр: <code><b>$numberstring = «59012341»</b></code>. </p>
<h3 class="p_Heading3"><span class="f_Heading3">Функция JobPosition</span></h3>
<p class="p_Normal">Эта функция используется для получения должности пользователя. </p>
<p class="p_Normal">Синтаксис функции: <code><b>JobPosition(&lt;param1:  пользователь&gt;, &lt;формат:строка&gt;)</b></code>. </p>
<p class="p_Normal">Вы можете использовать переменную <code><b>&laquo;first&raquo;</b></code> для передачи первой должности, и переменную <code><b>&laquo;all&raquo;</b></code> — для всех должностей пользователя.</p>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">начало&nbsp;примера</span></p>
<p class="p_Normal">Пример:</p>
<p class="p_Normal"><code><b>{JobPosition({$__createdBy},&laquo;all&raquo;)}</b></code> —&gt; функция передаст все должности пользователя, записанного в поле <span style="font-weight: bold;">Автор</span>.</p>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">конец&nbsp;примера</span></p>
<h3 class="p_Heading3"><span class="f_Heading3">Функция PasteImage</span></h3>
<p class="p_Normal">Чтобы вставить в шаблон документа изображение из контекстной переменной, используйте функцию <code><b>PasteImage</b></code>.</p>
<p class="p_Normal">Синтаксис функции: <code><b>PasteImage(&lt;param1:  изображение/файл&gt;, &lt;ширина в пикселях&gt;, &lt;высота в пикселях&gt;, &lt;обрезать вместо сжатия: true/false&gt;)</b></code></p>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">Начало&nbsp;примера</span></p>
<p class="p_Normal">Примеры:</p>
<ul style="list-style-type:disc">
<li class="p_Normal"><code><b>{PasteImage({$image})}</b></code> — вставка изображения с исходными значениями ширины и высоты;</li><li class="p_Normal"><code><b>{PasteImage({$image}, 200)}</b></code> — изображение отобразится с шириной 200 пикселей. Значение высоты изменится, исходные пропорции сохранятся;</li><li class="p_Normal"><code><b>{PasteImage({$image}, 200, 400)}</b></code> — функция масштабирует изображение до строго заданного размера;</li><li class="p_Normal"><code><b>{PasteImage({$image}, auto, 400)}</b></code> — изображение из переменной отобразится с высотой 400 пикселей. При этом значение ширины масштабируется, исходные пропорции сохранятся;</li><li class="p_Normal"><code><b>{PasteImage({$image}, 200, 400, true)}</b></code> — функция обрежет изображение до указанного размера без учёта исходных пропорций.</li></ul>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">Конец&nbsp;примера</span></p>
<h3 class="p_Heading3"><a id="hyperlink" class="hmanchor"></a><span class="f_Heading3">Функция HYPERLINK для таблиц</span></h3>
<p style="line-height: 1.28; margin: 0 0 11px 0;">При формировании шаблона в файле формата <span style="font-weight: bold;">.xls</span> и <span style="font-weight: bold;">.xlsx</span> можно использовать функцию <code><b>HYPERLINK</b></code>. Это стандартная функция программы Excel, которая позволяет преобразовать заданное значение в гиперссылку. </p>
<p style="line-height: 1.28; margin: 0 0 11px 0;">В качестве аргументов можно использовать переменные типа <a href="360009707032.html#string" class="topiclink">Строка</a> из контекста приложения, а также задать значения вручную. Для корректной работы функции указывается полный URL‑адрес ссылки. &nbsp;</p>
<p style="line-height: 1.28; margin: 0 0 11px 0;">Синтаксис функции: <code><b>HYPERLINK("{$param1: строка}" или "<полный url-адрес>";"{$param2: строка}" или "<значение гиперссылки>")</b></code>.</p>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">начало&nbsp;примера</span></p>
<p style="line-height: 1.28; margin: 0 0 11px 0;">Примеры:</p>
<ul style="list-style-type:disc">
<li class="p_Normal"><code><b>=HYPERLINK("{$site}";"Смотрите на официальном сайте")</b></code> — адрес сайта указан в виде строки в элементе приложения, значение гиперссылки задано вручную;</li><li class="p_Normal"><code><b>=HYPERLINK("https://elma365.com/ru/";"{$__name}")</b></code> — адрес сайта прописан вручную, значение гиперссылки формируется из поля в элементе приложения. </li></ul>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">конец&nbsp;примера</span></p>
<h3 class="p_Heading3"><a id="exttext" class="hmanchor"></a><span class="f_Heading3">Функция ExtText </span></h3>
<p class="p_Normal">Если для настройки шаблона системных функций недостаточно, вы можете создать пользовательскую функцию <code><b>ExtText</b></code>. Функция позволяет вызывать <a href="extention-api.html" class="topiclink">методы API</a>, описанные в пользовательских модулях, и применять их к генерируемому шаблону. </p>
<p class="p_Normal">Синтаксис функции: <code><b>{ExtText("id модуля", "адрес метода", {$дополнительный параметр})}</b></code>: </p>
<ul style="list-style-type:disc">
<li class="p_Normal"><span style="font-weight: bold;">id модуля</span> — символы из URL модуля, идущие после <span style="font-weight: bold;">/ext_</span>. Например, если URL модуля <span style="font-weight: bold;">mycompany.elma365.ru/admin/extensions/ext_12ab-1212</span>, в функцию нужно вставить <span style="font-weight: bold;">12ab-1212</span>; </li><li class="p_Normal"><span style="font-weight: bold;">адрес метода</span> — значение поля <span style="font-weight: bold;">Адрес</span> из таблицы, расположенной на вкладке <span style="font-weight: bold;">Методы API</span> в <a href="extention-api.html" class="topiclink">настройках модуля</a>.</li><li class="p_Normal"><span style="font-weight: bold;">дополнительный параметр</span> — опциональный параметр, который передаётся в указанный метод, например, свойство приложения. В теле запроса дополнительные параметры отображаются в виде <span style="font-weight: bold;">p1</span>, <span style="font-weight: bold;">p2</span> и т.д. Они передаются в функцию <code><b>ExtText</b></code> через запятую после обязательных параметров. Значения будут присваиваться параметрам в том порядке, в котором они объявлены в теле запроса.</li></ul>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">Начало&nbsp;примера</span></p>
<p class="p_Normal">Пример:</p>
<p class="p_Normal">Вы можете применить функцию <code><b>ExtText</b></code> в названии элемента приложения. Для этого:</p>
<ol style="list-style-type:decimal">
<li value="1" class="p_Normal">Создайте модуль и настройте в нём метод API, который будет использоваться для генерации названия элемента.</li><li value="2" class="p_Normal">Сформируйте <a href="360007679591.html#name_template" class="topiclink">название элемента по шаблону</a>, использовав функцию <code><b>ExtText</b></code>.</li></ol>
<p class="p_Normal" style="margin: 0 0 0 34px;">Например:</p>
<p style="line-height: 1.28; margin: 0 0 11px 34px;"><code><b>{ExtText("4c34-822c", "name", "Текст для примера", {$_index})}</b></code></p>
<ol style="list-style-type:decimal">
<li value="3" class="p_Normal">Функция запустит метод, внутри которого будут обрабатываться переданные параметры. После выполнения заданных в методе условий получим результат, который будет использоваться в качестве названия элемента приложения.</li></ol>
<p class="p_Normal"><a class="dropdown-toggle" style="font-style: normal; font-weight: normal; color: #000000; background-color: transparent; text-decoration: none;" href="javascript:HMToggle('toggle','TOGGLE0186AB')">Пример скрипта метода API для формирования названия элемента:</a></p>
<div id="TOGGLE0186AB" class="dropdown-toggle-body" style="text-align: left; text-indent: 0; line-height: 1.0; page-break-inside: avoid; padding: 0 0 0 0; margin: 0 0 0 0;"><table style="border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:0; border:none"><p class="p_CodeExample" style="white-space: normal; page-break-inside: auto;"><span class="f_CodeExample">async function name(req: HttpApiRequest): Promise&lt;HttpResponse | void&gt; {</span><br />
<span class="f_CodeExample"> &nbsp; &nbsp; const resp = new HttpResponse();</span><br />
<span class="f_CodeExample"> &nbsp; &nbsp; let result: string = &quot;&quot;;</span><br />
<span class="f_CodeExample"> &nbsp; &nbsp; let bodystr: string = req!.body!.toString();</span><br />
<span class="f_CodeExample"> &nbsp; &nbsp; </span><br />
<span class="f_CodeExample"> &nbsp; &nbsp; JSON.parse(bodystr, function (k, v) { // k и v - ключ и значение</span><br />
<span class="f_CodeExample">&nbsp;</span><br />
<span class="f_CodeExample"> &nbsp; &nbsp; &nbsp; &nbsp; if (k != '') { // вы можете задать свои условия</span><br />
<span class="f_CodeExample"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; result += &quot;_key&quot;+k</span><br />
<span class="f_CodeExample"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; result += &quot;_value&quot;+v</span><br />
<span class="f_CodeExample"> &nbsp; &nbsp; &nbsp; &nbsp; }</span><br />
<span class="f_CodeExample">&nbsp;</span><br />
<span class="f_CodeExample"> &nbsp; });</span><br />
<span class="f_CodeExample">&nbsp;</span><br />
<span class="f_CodeExample"> &nbsp; &nbsp; resp</span><br />
<span class="f_CodeExample"> &nbsp; &nbsp; &nbsp; &nbsp;.status(200)</span><br />
<span class="f_CodeExample"> &nbsp; &nbsp; &nbsp; &nbsp;.content(result)</span><br />
<span class="f_CodeExample"> &nbsp; &nbsp; &nbsp; &nbsp;.set('Content-Type', 'text/html')</span><br />
<span class="f_CodeExample">&nbsp;</span><br />
<span class="f_CodeExample"> &nbsp; &nbsp;return resp</span><br />
<span class="f_CodeExample">}</span></p>
</td>
</tr>
</table>
</div>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">Конец&nbsp;примера</span></p>
<p class="p_Normal"><a id="feature-flag" class="hmanchor"></a>При использовании сложных пользовательских функций, вы можете изменить режим их обработки для ускорения генерации документов по шаблону. Все переменные и функции будут обрабатываться не последовательно друг за другом, а параллельно.</p>
<p class="p_Normal">Для этого можно включить фича-флаг <code><b>enableConcurrencyTemplateMapper</b></code> в следующих поставках:</p>
<ul style="list-style-type:disc">
<li class="p_Normal">ELMA365 On-premises Enterprise — в конфигурационном файле <code><b>values-elma365.yaml</b></code>, подробнее читайте в статье <a href="change-settings-enterprise.html#enable-feature-flag-enterpeise" class="topiclink">«Изменение параметров ELMA365 Enterprise»</a>;</li><li class="p_Normal">ELMA365 On-Premises Standard — в конфигурационном файле <code><b>config-elma365.txt</b></code>, подробнее читайте в статье <a href="change-elma365standard-parameters.html#enable-feature-flag-standard" class="topiclink">«Изменение параметров ELMA365 Standard»</a>;</li><li class="p_Normal">ELMA365 SaaS Enterpise — обратитесь к вашему менеджеру ELMA365.</li></ul>
<p class="p_Normal">После включения фича-флага можно задать количество параллельных потоков обработки с помощью <a href="change-settings-enterprise.html#parallel-processing" class="topiclink">дополнительных параметров</a>.</p>
<h2 class="p_Heading2" style="margin: 19px 0 0 0;"><a id="if" class="hmanchor"></a><span class="f_Heading2" style="font-size: 24px;">Условия</span></h2>
<p class="p_Normal" style="margin: 19px 0 0 0;">В зависимости от условия, в документе можно вывести тот или иной текст.</p>
<p class="p_Normal" style="margin: 14px 0 0 0;">Условие начинается с оператора <code><b>{if <условие>}</b></code> и заканчивается оператором <code><b>{end}</b></code>. Здесь <code><b>&lt;условие&gt;</b></code> — это любое условие, например, <code><b>{$имя_переменной} = «Да»</b></code>.</p>
<p class="p_CodeExample" style="white-space: normal; page-break-inside: auto; page-break-after: avoid;"><span class="f_CodeExample">начало примера</span></p>
<p class="p_Normal" style="page-break-after: avoid; margin: 14px 0 0 0;">Пример 1:</p>
<p style="page-break-after: avoid; margin: 14px 0 0 0;"><code><b>{if {$user_name} = «Петров Илья»} С уважением, Петров Илья {end}</b></code><span style="font-family: 'Courier New',Courier,monospace; font-weight: bold;"> </span>—&gt;<span style="font-weight: bold;"> </span>в функции задаётся условие для проверки имени пользователя. Если значение в поле совпадёт, отобразится указанный текст<span style="color: #394149;">.</span></p>
<p class="p_Normal" style="page-break-after: avoid; margin: 14px 0 0 0;"><span style="font-weight: bold;">Пример 2:</span></p>
<p class="p_Normal" style="page-break-after: avoid;"><code><b>{if {$week.day} = «Пятница»}</b></code></p>
<p class="p_Normal" style="page-break-after: avoid;"><code><b>До свидания, хороших выходных!</b></code></p>
<p class="p_Normal" style="page-break-after: avoid;"><code><b>{else}</b></code></p>
<p class="p_Normal" style="page-break-after: avoid;"><code><b>До свидания!</b></code></p>
<p class="p_Normal" style="page-break-after: avoid;"><code><b>{end}</b></code><span style="font-family: 'Courier New',Courier,monospace; font-weight: bold;"> </span>—&gt; в примере проверяется текущий день недели. В зависимости от его значения отобразится один из вариантов указанного текста<span style="color: #394149;">.</span></p>
<p class="p_CodeExample" style="white-space: normal; page-break-inside: auto; page-break-after: avoid;"><span class="f_CodeExample">конец примера</span></p>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">начало&nbsp;внимание</span></p>
<p style="line-height: 1.28; margin: 0 0 11px 0;"><span style="font-size: 15px; font-family: Inter;">При использовании многострочных условий для файлов формата </span><span style="font-size: 15px; font-family: Inter; font-weight: bold;">.xlsx</span><span style="font-size: 15px; font-family: Inter;"> нельзя располагать дополнительный текст в строках с операторами </span><code><b>{if &lt;условие&gt;}</b></code><span style="font-size: 15px; font-family: Inter;">, </span><code><b>{else}</b></code><span style="font-size: 15px; font-family: Inter;"> и </span><code><b>{end}</b></code><span style="font-size: 15px; font-family: Inter;">. При генерации документа он удаляется.</span></p>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">конец&nbsp;внимание</span></p>
<p class="p_Normal" style="margin: 19px 0 0 0;">Обратите внимание, для переменных типа<span style="font-weight: bold;"> </span><a href="360009707032.html#yes_no" class="topiclink">Выбор «да/нет»</a> нужно указывать значения из поля <span style="font-weight: bold;">Варианты</span>. По умолчанию это <span style="font-weight: bold;">Да</span> и <span style="font-weight: bold;">Нет</span>.</p>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">Начало&nbsp;примера</span></p>
<p class="p_Normal" style="margin: 14px 0 0 0;">Пример:</p>
<p style="line-height: 1.28; margin: 0 0 11px 0;"><code><b>{if {$options} <> «Нет»} Текст для примера {end}</b></code><span style="font-family: 'Courier New',Courier,monospace;"> </span>—&gt; текст будет отображаться только в том случае, если выбрано значение<span style="font-weight: bold;"> Да</span><span style="color: #394149;">.</span></p>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">Конец&nbsp;примера</span></p>
<p class="p_Normal">В функции можно проверять наличие значений у свойств элемента приложения. Если поле на форме заполнено, можно вывести его значение.</p>
<p class="p_Normal">Для<span style="color: #394149;"> </span>свойства типа<span style="color: #394149;"> <a href="360009707032.html#app" class="topiclink">Приложение</a> </span>или<span style="color: #394149;"> <a href="360009707032.html#file_type" class="topiclink">Файлы</a> </span>функция условия применяется, если в нём содержится только одно значение, т. е. для свойства включена опция <span style="font-weight: bold;">Один</span>. Когда отмечена опция <span style="font-weight: bold;">Несколько</span>, используется<span style="color: #394149;"> <a href="360027003711.html#cycle" class="topiclink">Цикл for</a>.</span></p>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">Начало&nbsp;примера</span></p>
<p class="p_Normal">Пример:</p>
<p style="background: #f7f7f7; margin: 0 0 16px 0;"><code><b>{if {$document}} {$document} {end}</b></code><span style="font-family: 'Courier New',Courier,monospace; font-weight: bold;"> </span>—&gt;<span style="font-weight: bold;"> </span>если в поле типа <span style="font-weight: bold;">Файлы</span> загружен документ, в сгенерированном файле отобразится его название<span style="color: #394149;">.</span></p>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">конец&nbsp;примера</span></p>
<h3 class="p_Heading3" style="margin: 19px 0 0 0;"><span class="f_Heading3" style="font-size: 19px;">Условные операторы</span></h3>
<p class="p_Normal" style="margin: 19px 0 0 0;">При написании условий вы можете использовать следующие операторы:</p>
<ul style="list-style-type:disc">
<li class="p_Normal" style="margin-top: 14px; margin-right: 0; margin-bottom: 0;"><span style="font-weight: bold;">= </span>— равно; </li><li class="p_Normal"><span style="font-weight: bold;">&lt;&gt;</span> — не равно; </li><li class="p_Normal"><span style="font-weight: bold;">&gt;</span> — больше; </li><li class="p_Normal"><span style="font-weight: bold;">&gt;=</span> — больше или равно; </li><li class="p_Normal"><span style="font-weight: bold;">&lt;</span> — меньше; </li><li class="p_Normal"><span style="font-weight: bold;">&lt;=</span> — меньше или равно. </li></ul>
<h3 class="p_Heading3"><span class="f_Heading3">Логические операторы OR и AND</span></h3>
<p class="p_Normal">Для создания сложных условий можно использовать операторы <code><b>OR</b></code> и <code><b>AND</b></code>, которые позволяют задавать несколько условий в виде одной конструкции. </p>
<p class="p_Normal">При использовании <code><b>OR</b></code> достаточно, чтобы выполнилось хотя бы одно из указанных условий. </p>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">начало&nbsp;примера</span></p>
<p class="p_Normal">Пример: </p>
<p class="p_Normal"><code><b>{if {$trip.location_type} = «Гостиница» OR {$trip.location_type} = «Квартира принимающей стороны»}</b></code></p>
<p class="p_Normal"><code><b>{$business_trip_request.city}</b></code></p>
<p class="p_Normal"><code><b>{end}</b></code></p>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">конец&nbsp;примера</span></p>
<p class="p_Normal">При использовании <code><b>AND</b></code> нужно, чтобы выполнялись все перечисленные условия. </p>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">начало&nbsp;примера</span></p>
<p class="p_Normal">Пример: </p>
<p class="p_Normal"><code><b>{if {$item.price} < 5000 AND {$item.isAvailable}} </b></code></p>
<p class="p_Normal"><code><b>{$item.name}</b></code></p>
<p class="p_Normal"><code><b>{end}</b></code></p>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">конец&nbsp;примера</span></p>
<p class="p_Normal">Условия с логическими операторами <code><b>OR</b></code> и <code><b>AND</b></code> можно комбинировать, используя скобки. </p>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">начало&nbsp;примера</span></p>
<p class="p_Normal">Пример: </p>
<p class="p_Normal"><code><b>{if ({$business_trip_request.location_type} = «Гостиница» OR {$business_trip_request.location_type} = «Квартира принимающей стороны») AND ({$business_trip_request.price} < 5000)} </b></code></p>
<p class="p_Normal"><code><b>{$business_trip_request.city}</b></code></p>
<p class="p_Normal"><code><b>{end}</b></code></p>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">конец&nbsp;примера</span></p>
<h2 class="p_Heading2" style="margin: 19px 0 0 0;"><a id="cycle" class="hmanchor"></a><span class="f_Heading2" style="font-size: 24px;">Цикл for</span></h2>
<p class="p_Normal" style="margin: 19px 0 0 0;">Цикл <code><b>for</b></code> используется для того, чтобы отобразить в документе список, например, несколько товаров один за другим.</p>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">начало&nbsp;примера</span></p>
<p class="p_Normal" style="margin: 19px 0 0 0;">Пример:</p>
<p style="margin: 14px 0 0 0;"><code><b>{for fr in {$tovar} }</b></code></p>
<p><code><b>заказан товар — {$fr}</b></code></p>
<p><code><b>{end}</b></code></p>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">конец&nbsp;примера</span></p>
<p class="p_Normal" style="margin: 14px 0 0 0;">При <a href="360026936731.html" class="topiclink">загрузке шаблона в систему</a> и извлечении цикла <code><b>for</b></code> из документа, поле для переменной будет определено как <span style="font-weight: bold;">список</span>.</p>
<p class="p_Normal" style="margin: 14px 0 0 0;"><img alt="синт шабл 1" width="460" height="189" style="margin:0;width:460px;height:189px;border:none" src="hmfile_hash_44ec1a11.png"/></p>
<h3 class="p_Heading3"><span class="f_Heading3">for для приложений</span></h3>
<p class="p_Normal" style="margin: 19px 0 0 0;">Цикл <code><b>for</b></code> можно использовать, чтобы отображать данные из приложения. </p>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">начало&nbsp;примера</span></p>
<p class="p_Normal" style="margin: 19px 0 0 0;">Пример:</p>
<p style="line-height: 1.38; margin: 5px 0 0 0;"><code><b>{for fr in {$appListField} }</b></code></p>
<p style="line-height: 1.38; margin: 5px 0 0 0;"><code><b>Приложение — {$fr}, с именем {$fr.__name} на сумму {$fr.money}</b></code></p>
<p style="line-height: 1.38; margin: 5px 0 0 0;"><code><b>{end}</b></code></p>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">конец&nbsp;примера</span></p>
<p class="p_Normal" style="margin: 19px 0 0 0;">Такой же цикл позволяет записать данные приложения в таблицу.</p>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">начало&nbsp;внимание</span></p>
<p style="line-height: 1.28; margin: 0 0 11px 0;"><span style="font-size: 15px; font-family: Inter;">Для файлов формата </span><span style="font-size: 15px; font-family: Inter; font-weight: bold;">.xlsx</span><span style="font-size: 15px; font-family: Inter;"> в строках с операторами </span><code><b>{for &lt;выражение&gt;}</b></code><span style="font-size: 15px; font-family: Inter;"> и </span><code><b>{end}</b></code><span style="font-size: 15px; font-family: Inter;"> нельзя располагать дополнительный текст. При генерации документа он удаляется. Исключение составляет текст в </span><span style="font-size: 15px; font-family: Inter; color: #0563c1;"><a href="360027003711.html#merged-cells" class="topiclink">объединённых ячейках</a></span><span style="font-size: 15px; font-family: Inter;">.</span></p>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">конец&nbsp;внимание</span></p>
<p style="line-height: 1.28; margin: 0 0 11px 0;"><span style="font-size: 13px; color: #000000;">&nbsp;</span></p>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">начало&nbsp;примера</span></p>
<p class="p_Normal" style="margin: 19px 0 0 0;">Пример: </p>
<p style="line-height: 1.38; margin: 5px 0 0 0;"><code><b>{for fr in {$appListField} }</b></code></p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 0;"><table style="border:none; border-spacing:0; border-collapse:collapse;">
<tr>
<td style="vertical-align:top; width:141px; padding:4px; border:solid thin #000000;"><p style="line-height: 1.28; margin: 0 0 11px 0;"><code><b>{$fr}</b></code></p>
</td>
<td style="vertical-align:top; width:141px; padding:4px; border:solid thin #000000;"><p style="line-height: 1.28; margin: 0 0 11px 0;"><code><b>{$fr.__name}</b></code></p>
</td>
<td style="vertical-align:top; width:141px; padding:4px; border:solid thin #000000;"><p style="line-height: 1.28; margin: 0 0 11px 0;"><code><b>{$fr.money}</b></code></p>
</td>
</tr>
</table>
</div>
<p style="line-height: 1.38; margin: 5px 0 0 0;"><code><b>{end}</b></code></p>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">конец&nbsp;примера</span></p>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">начало&nbsp;внимание</span></p>
<p style="line-height: 1.28; margin: 0 0 11px 0;">В системах версии 2023.12 и ниже при работе с приложениями названия полей в шаблоне следует указывать без префикса <code><b>data</b></code>. С версии 2024.1 генерация сработает корректно при использовании префикса. </p>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">конец&nbsp;внимание</span></p>
<h3 class="p_Heading3"><a id="table-cycle" class="hmanchor"></a><span class="f_Heading3">for для таблиц</span></h3>
<p class="p_Normal" style="margin: 19px 0 0 0;">Для корректной работы цикла при <a href="360026936731.html#add_variables" class="topiclink">загрузке шаблона</a> в систему укажите тип данных <a href="360009707032.html#table" class="topiclink">Таблица</a> для переменной в цикле. </p>
<p class="p_Normal" style="margin: 19px 0 0 0;"><img alt="for-table" width="651" height="347" style="margin:0;width:651px;height:347px;border:none" src="for-table.png"/></p>
<p class="p_Normal" style="margin: 19px 0 0 0;">Если вам нужно выгрузить в документ данные из <a href="360010201779.html" class="topiclink">таблицы</a> ELMA365, например, список товаров с указанием их количества и стоимости, заполненный в процессе обработки заказа, вы можете использовать шаблон в формате <span style="font-weight: bold;">.xlsx</span>.</p>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">начало&nbsp;внимание</span></p>
<p class="p_Normal">В системах версии 2023.12 и ниже при работе с таблицами перед именами полей в шаблоне следует указывать префикс <code><b>row.data</b></code>. С версии 2024.1 использование <code><b>data</b></code> не влияет на корректную генерацию файла.</p>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">конец&nbsp;внимание</span></p>
<p class="p_Normal" style="margin: 14px 0 0 0;">Настраивая шаблон, используйте цикл <code><b>for</b></code> и укажите переменную процесса, в которой хранятся данные таблицы. </p>
<p style="line-height: 1.28; margin: 0 0 11px 0;">При создании шаблона в файле формата <span style="font-weight: bold;">.xlsx</span> команды <code><b>for</b></code> и <code><b>end</b></code> должны быть в первом столбце таблицы, иначе введённый текст отобразится некорректно.<span style="font-size: 11px; color: #394149;"> </span>Далее вам нужно указать в шаблоне коды соответствующих полей приложения.</p>
<p class="p_Normal" style="margin: 14px 0 0 0;">Например, для колонки, в которой будет отображаться стоимость, укажем <code><b>{$row.data.item_price}</b></code> или <code><b>{$row.item_price}</b></code>, начиная с версии системы 2024.1.</p>
<p class="p_Normal" style="margin: 14px 0 0 0;">В функции <code><b>item_price</b></code> — это код поля <span style="font-weight: bold;">Стоимость</span>. Префикс <code><b>row.data</b></code> или <code><b>row</b></code> обращается к элементу в цикле и позволяет заполнить в документе столько строк, сколько заполнено в таблице в ELMA365.</p>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">начало&nbsp;внимание</span></p>
<p style="line-height: 1.28; margin: 0 0 11px 0;"><span style="font-size: 15px; font-family: Inter;">В строках таблицы с операторами </span><code><b>{for &lt;выражение&gt;}</b></code><span style="font-size: 15px; font-family: Inter;"> и </span><code><b>{end}</b></code><span style="font-size: 15px; font-family: Inter;"> нельзя располагать дополнительный текст. При генерации документа он удаляется. Исключение составляет текст в </span><span style="font-size: 15px; font-family: Inter; color: #0563c1;"><a href="360027003711.html#merged-cells" class="topiclink">объединённых ячейках</a></span><span style="font-size: 15px; font-family: Inter;">.</span></p>
<p class="p_CodeExample" style="page-break-inside: avoid;"><span class="f_CodeExample">конец&nbsp;внимание</span></p>
<p class="p_Normal" style="margin: 14px 0 0 0;">Шаблон документа формата <span style="font-weight: bold;">.xlsx</span> для таблицы, в которой указан товар, его стоимость, количество и итоговая сумма к оплате, может выглядеть следующим образом:</p>
<p class="p_Normal" style="margin: 14px 0 0 0;"><img alt="template-syntax-4" width="587" height="146" style="margin:0;width:587px;height:146px;border:none" src="template-syntax-4.png"/></p>
<p class="p_Normal">Вы также можете добавить условие <code><b>if</b></code> в цикл <code><b>for</b></code>. Пример смотрите в статье <a href="ready-made-sheets-settings.html#app-file-template" class="topiclink">«Настройки шаблонов для листов согласования и ознакомления»</a>. Обратите внимание, для файлов формата <span style="font-weight: bold;">.xlsx</span> в строках с операторами <code><b>{for <выражение>}</b></code> и <code><b>{end}</b></code> нельзя располагать другой текст, так как он удаляется при генерации. Исключение составляют объединённые по вертикали ячейки.</p>
<h3 class="p_Heading3"><span class="f_Heading3">Шаблон для таблицы в файле формата .docx</span></h3>
<p class="p_Normal">Чтобы генерировать таблицу по шаблону в файле формата <span style="font-weight: bold;">.docx</span>: </p>
<ol style="list-style-type:upper-roman">
<li value="1" class="p_Normal">Отделите первую строку таблицы с помощью опции <span style="font-weight: bold;">Разделить таблицу</span>. </li><li value="2" class="p_Normal">В появившейся пустой строке объявите цикл <code><b>for</b></code>. </li><li value="3" class="p_Normal">Настройте шаблон в таблице, указав переменные из контекста бизнес-процесса. </li><li value="4" class="p_Normal">Под таблицей закройте цикл командой <code><b>end</b></code>. </li></ol>
<p class="p_Normal">Например, шаблон для таблицы в документе может выглядеть следующим образом: </p>
<p style="line-height: 1.28; margin: 0 0 11px 0;"><img alt="template-syntax-5" width="638" height="148" style="margin:0;width:638px;height:148px;border:none" src="template-syntax-5.png"/></p>
<h3 class="p_Heading3"><span class="f_Heading3">Вложенные таблицы</span></h3>
<p style="line-height: 1.28; margin: 0 0 11px 0;"><span style="font-size: 15px; font-family: Inter;">Цикл </span><code><b>for</b></code><span style="font-size: 15px; font-family: Inter;"> можно использовать, чтобы создать вложенную таблицу. Для обращения к колонкам вложенной таблицы вместо </span><code><b>row.data</b></code><span style="font-size: 15px; font-family: Inter;"> или </span><code><b>row</b></code><span style="font-size: 15px; font-family: Inter;"> используется другой префикс, например, </span><code><b>subrow.data</b></code><span style="font-size: 15px; font-family: Inter;"> в версиях системы 2023.11 и ниже или </span><code><b>subrow</b></code><span style="font-size: 15px; font-family: Inter;"> начиная с 2024.1.</span></p>
<p style="line-height: 1.28; margin: 0 0 11px 0;"><img alt="template-syntax-7" width="623" height="189" style="margin:0;width:623px;height:189px;border:none" src="template-syntax-7.png"/></p>
<p class="p_Normal"><a id="merged-cells" class="hmanchor"></a>Обратите внимание, в строках с операторами <code><b>{for &lt;выражение&gt;}</b></code> и <code><b>{end}</b></code> нельзя располагать другой текст, так как он удаляется при генерации. Исключение составляют объединённые по вертикали ячейки. Например, при генерации по такому шаблону значение переменной <code><b>{$row.author}</b></code> отобразится в таблице:</p>
<p style="line-height: 1.28; margin: 0 0 11px 0;"><img alt="template-syntax-8" width="576" height="164" style="margin:0;width:576px;height:164px;border:none" src="template-syntax-8.png"/></p>
<h3 class="p_Heading3"><span class="f_Heading3">Вывести порядковый номер в таблице</span></h3>
<p class="p_Normal">С помощью цикла <code><b>for</b></code> можно выводить в шаблоне таблицы порядковый номер строки. Для этого используется префикс <code><b>row.data</b></code> и системное свойство <code><b>__index</b></code>. В версии системы 2024.1 и выше указывается строка вида <code><b>{$row.__index}</b></code>.</p>
<p class="p_Normal">Например, шаблон для таблицы с номером строки, названием товара и его стоимостью можно создать следующим образом: </p>
<p style="margin: 14px 0 0 0;"><img alt="template_syntax-6" width="490" height="140" style="margin:0;width:490px;height:140px;border:none" src="template_syntax-6.png"/></p>

                        <div class="bottom-nav">
                            
                                <a id="prev-link" class="topic__navi_prev" href="360026936731.html">
                                    <span class="bottom-nav__arrow bottom-nav__arrow--prev"></span> <span
                                        class="bottom-nav__link">360026936731.html</span>
                                </a>
                            
                            
                                <a id="next-link" class="topic__navi_next" href="360012267032.html">
                                    <span class="bottom-nav__link">360012267032.html</span> <span
                                        class="bottom-nav__arrow bottom-nav__arrow--next"></span>
                                </a>
                            
                        </div>
                        <!-- добавляет на страницу строку блок Была ли статья полезной?  -->
                          <div class="feedback-wrap"><div class="feedback" id="feedback"><span><b>Была ли статья полезной?</b></span><form action="" method="POST" class="feedback-form" id="feedback-form"><div class="feedback__popup feedback__popup-response" id="feedback__popup_thx">Спасибо за ваш отзыв!</div><div id="feedback-success-popup"><div class="wrap"><button type="button" class="feedback-popup-close">×</button><svg width="44" height="44" viewBox="0 0 44 44" fill="none" xmlns="http://www.w3.org/2000/svg"><g clip-path="url(#clip0_212_2187)"><path d="M22 0.6875C10.2294 0.6875 0.6875 10.2294 0.6875 22C0.6875 33.7706 10.2294 43.3125 22 43.3125C33.7706 43.3125 43.3125 33.7706 43.3125 22C43.3125 10.2294 33.7706 0.6875 22 0.6875ZM22 40.5625C11.8023 40.5625 3.4375 32.3078 3.4375 22C3.4375 11.8024 11.6922 3.4375 22 3.4375C32.1977 3.4375 40.5625 11.6922 40.5625 22C40.5625 32.1976 32.3078 40.5625 22 40.5625ZM34.1713 16.933L18.6613 32.3186C18.257 32.7197 17.604 32.7171 17.203 32.3128L9.82283 24.873C9.42176 24.4686 9.42434 23.8157 9.82867 23.4146L10.5609 22.6884C10.9652 22.2873 11.6181 22.2899 12.0192 22.6942L17.9468 28.6697L31.9926 14.7366C32.3969 14.3356 33.0498 14.3382 33.4509 14.7425L34.1772 15.4747C34.5783 15.879 34.5757 16.532 34.1713 16.933Z" fill="#27AE60"></path></g><defs><clipPath id="clip0_212_2187"><rect width="44" height="44" fill="white"></rect></clipPath></defs></svg><p>Ваш отзыв успешно отправлен!</p><span>Спасибо за обратную связь.</span></div></div><div class="feedback__popup" id="feedback__popup_why"><button type="button" class="feedback-popup-close">×</button><div class="feedback__popup-header">Уточните, почему:</div><input type="radio" name="category" id="bad_recommendation" value="bad_recommendation"><label for="bad_recommendation">Рекомендации не помогли</label><input type="radio" name="category" id="difficult_text" value="difficult_text"><label for="difficult_text">Текст трудно понять</label><input type="radio" name="category" id="no_answer" value="no_answer"><label for="no_answer">Нет ответа на мой вопрос</label><input type="radio" name="category" id="bad_header" value="bad_header"><label for="bad_header">Содержание статьи не соответствует заголовку</label><input type="radio" name="category" id="other_reason" value="other_reason"><label for="other_reason">Другая причина</label></div><div class="feedback__popup" id="feedback__popup-other"><button type="button" class="feedback-popup-close">×</button>   <div class="feedback__popup-header">Расскажите, что вам не понравилось в статье:</div><textarea class="feedback__textarea" name="other" id=""></textarea><input type="submit" class="feedback__other-btn" value="Отправить"></div><div class="feedback-form__btn-group"><input type="radio" name="useful" id="feedback__useful_yes" value="true"><label for="feedback__useful_yes"><img src="like.svg"/><span class="feedback-form__btn-group_yes-btn">Да</span></label><input type="radio" name="useful" id="feedback__useful_no" value="false"><label for="feedback__useful_no"><img src="dislike.svg"/><span class="feedback-form__btn-group_no-btn">Нет</span></label></div><select name="category"><option disabled>Выберите вариант</option><option value="bad_recommendation" selected>Рекомендации не помогли</option><option value="difficult_text">Текст трудно понять</option><option value="no_answer">Нет ответа на мой вопрос</option><option value="bad_header">Содержание статьи не соответствует заголовку</option><option value="other_reason">Другая причина</option></select><input type="submit"></form></div></div>
                           
                    </section>
                </div>
                <aside class="article__sidebar" style="display:none">
                    <input type="checkbox" />
                    <div class="article__arrow"></div>
                    <div class="table-of-contents elma365-right" id="toc2Content">
                        <h3 class="h3-toc">В этой статье</h3>
                        <nav id="toc2"></nav>
                    </div>
                </aside>
            </div>
        </article>
    </main>               
    <footer class="footer">
        <div class="footer-container">
  <div class="footer-mobile">
    
      <ul class="footer-mobile__list"><li><a href="https://api.elma365.com/ru/" target="_blank">API</a></li><li><a href="https://tssdk.elma365.com/" target="_blank">TS SDK</a></li><li><a href="https://community.elma365.com/" target="_blank">Community</a></li><li><a href="https://elma-academy.com/ru/elma365" target="_blank">Академия</a></li></ul><ul class="footer-mobile__list"><li><a href="https://elma365.com/ru/help/platform/get-trial.html">Платформа</a></li><li><a href="https://elma365.com/ru/help/ecm/ecm-functions.html">ECM</a></li><li><a href="https://elma365.com/ru/help/service/service-functions.html">Service</a></li><li><a href="https://elma365.com/ru/help/projects/projects-functions.html">Проекты</a></li></ul>
    
    
  </div>
  <div class="container">
    <div class="footer-wrap">
      
        <div><span class="mobile-question-popup">Отправить фидбэк</span><form method="POST" action class="question__popup question-xs" id="question__popup"><div class="question-wrap"><span class="close"></span><span class="title">Задать вопрос</span><label for="help_question" style="display: none;"></label><textarea name="help_question" id="help_question"></textarea><input type="submit" value="Отправить"></div></form><div class="hidden fade-in question-success-xs">Ваш фидбэк отправлен.</div></div>
      
      <div class="footer-flex-b">
        <div class="footer-top">
          <span class="footer-copy">&copy; 2025 
              ELMA365
            
            
          </span>
          
            <a href="https://navigator.sk.ru/orn/1122971" target="_blank">
              <img src="sk-resident.svg" alt="sk icon" class="footer-img" width="117" height="34">
            </a>
            
        </div>
        <div class="footer-line">
          
            <div class="footer-line-copy">
              <span class="footer-copy">&copy; 2025 
                  ELMA365
                
                
              </span>
            </div>
            
              <ul class="footer-list">
                
                  <li class="footer-item"><a href="https://elma365.com/ru/" target="_blank" class="footer-link" style="color: #0D4A75;"><img src="browse.svg" alt="browse icon" class="footer-img">elma365.com</a></li><li class="footer-item"><a href="https://www.youtube.com/user/ELMABPM" target="_blank" class="footer-link"><img src="yt.svg" alt="youtube icon" class="footer-img"></a></li><li class="footer-item"><a href="https://vk.com/elma_bpm" target="_blank" class="footer-link"><img src="vk.svg" alt="vk icon" class="footer-img"></a></li><li class="footer-item"><a href="https://t.me/elmaday" target="_blank" class="footer-link"><img src="tg.svg" alt="telegram icon" class="footer-img"></a></li><li class="footer-item"><a href="https://dzen.ru/elma" target="_blank" class="footer-link"><img src="dzen.svg" alt="dzen icon" class="footer-img"></a></li>
                
                
                  <li class="footer-item">
                    <a href="https://navigator.sk.ru/orn/1122971" target="_blank">
                      <img src="sk-resident.svg" alt="sk icon" class="footer-img" width="117" height="34">
                    </a>
                  </li>
                
                
              </ul>
        </div>
      </div>
    </div>
  </div>
  <a href="#" class="arrow-top"></a>
</div>
 
    </footer>
    <iframe name="hmnavigation" style="display:none!important"></iframe>
    <script src="./jquery-ui.js"></script>
    <!--script src="//cdn.jsdelivr.net/npm/featherlight@1.7.14/release/featherlight.min.js" type="text/javascript" charset="utf-8"></script-->
    <script src="./jquery.tocify.min.js"></script>
    <script src="./TypoReporter.min.js"></script>
    <script src="./google-search.js"></script>
    <script src="./main.js"></script>
<script type="text/javascript">
HMInitToggle('TOGGLE0186A1','hm.type','dropdown','hm.state','0');
HMInitToggle('TOGGLE0186A2','hm.type','dropdown','hm.state','0');
HMInitToggle('TOGGLE0186A3','hm.type','dropdown','hm.state','0');
HMInitToggle('TOGGLE0186A4','hm.type','dropdown','hm.state','0');
HMInitToggle('TOGGLE0186A5','hm.type','dropdown','hm.state','0');
HMInitToggle('TOGGLE0186A6','hm.type','dropdown','hm.state','0');
HMInitToggle('TOGGLE0186A7','hm.type','dropdown','hm.state','0');
HMInitToggle('TOGGLE0186A8','hm.type','dropdown','hm.state','0');
HMInitToggle('TOGGLE0186A9','hm.type','dropdown','hm.state','0');
HMInitToggle('TOGGLE0186AA','hm.type','dropdown','hm.state','0');
HMInitToggle('TOGGLE0186AB','hm.type','dropdown','hm.state','0');
</script>
</body>

</html>
